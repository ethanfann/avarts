{"version":3,"sources":["node_modules/browser-pack/_prelude.js","package.json","node_modules/@mapbox/corslite/corslite.js","node_modules/@mapbox/sanitize-caja/index.js","node_modules/@mapbox/sanitize-caja/sanitizer-bundle.js","node_modules/mustache/mustache.js","src/config.js","src/feature_layer.js","src/feedback.js","src/format_url.js","src/geocoder.js","src/geocoder_control.js","src/grid.js","src/grid_control.js","src/grid_layer.js","src/legend_control.js","src/load_tilejson.js","src/map.js","src/mapbox.js","src/mapbox_logo.js","src/marker.js","src/request.js","src/share_control.js","src/simplestyle.js","src/style_layer.js","src/tile_layer.js","src/util.js"],"names":["corslite","url","callback","cors","isSuccessful","status","loaded","undefined","x","call","sent","window","XMLHttpRequest","Error","m","match","location","protocol","hostname","port","XDomainRequest","original","apply","this","arguments","that","args","setTimeout","onload","onreadystatechange","readyState","onerror","evt","onprogress","ontimeout","onabort","open","send","module","exports","cleanUrl","test","getScheme","toString","getPath","cleanId","id","html_sanitize","require","_","URI","parse","uriStr","URI_RE_","nullIfAbsent","create","scheme","credentials","domain","path","query","fragment","uri","encodeIfExists2","URI_DISALLOWED_IN_SCHEME_OR_CREDENTIALS_","encodeIfExists","URI_DISALLOWED_IN_PATH_","setRawQuery","replace","encodeOne","setAllParameters","unescapedPart","encodeURIComponent","extra","encodeURI","ch","n","charCodeAt","charAt","normPath","collapse_dots","q","p","r","PARENT_DIRECTORY_HANDLER_RE","resolve","baseUri","relativeUri","absoluteUri","clone","overridden","hasScheme","setRawScheme","getRawScheme","hasCredentials","setRawCredentials","getRawCredentials","hasDomain","setRawDomain","getRawDomain","hasPort","rawPath","getRawPath","simplifiedPath","setPort","getPort","EXTRA_PARENT_PATHS_RE","absRawPath","slash","lastIndexOf","substring","setRawPath","hasQuery","getRawQuery","hasFragment","setRawFragment","getRawFragment","rawScheme","rawCredentials","rawDomain","rawQuery","rawFragment","scheme_","credentials_","domain_","port_","path_","query_","fragment_","paramCache_","matchPart","length","PARENT_DIRECTORY_HANDLER","RegExp","prototype","out","push","join","decodeURIComponent","toLowerCase","setScheme","newScheme","getCredentials","setCredentials","newCredentials","getDomain","setDomain","newDomain","newPort","Number","setPath","newPath","String","hasPath","getQuery","setQuery","newQuery","params","Array","Object","newParams","i","k","v","queryBuf","separator","j","checkParameterCache_","cgiParams","split","setParameterValues","key","values","newValueIndex","pc","removeParameter","getAllParameters","slice","getParameterValues","paramNameUnescaped","getParameterMap","paramMap","value","getParameterValue","getFragment","setFragment","newFragment","utils","mimeTypeOf","base","html4","atype","NONE","URI_FRAGMENT","SCRIPT","STYLE","HTML","ID","IDREF","IDREFS","GLOBAL_NAME","LOCAL_NAME","CLASSES","FRAME_TARGET","MEDIA_QUERY","ATTRIBS","*::class","*::dir","*::draggable","*::hidden","*::id","*::inert","*::itemprop","*::itemref","*::itemscope","*::lang","*::onblur","*::onchange","*::onclick","*::ondblclick","*::onfocus","*::onkeydown","*::onkeypress","*::onkeyup","*::onload","*::onmousedown","*::onmousemove","*::onmouseout","*::onmouseover","*::onmouseup","*::onreset","*::onscroll","*::onselect","*::onsubmit","*::onunload","*::spellcheck","*::style","*::title","*::translate","a::accesskey","a::coords","a::href","a::hreflang","a::name","a::onblur","a::onfocus","a::shape","a::tabindex","a::target","a::type","area::accesskey","area::alt","area::coords","area::href","area::nohref","area::onblur","area::onfocus","area::shape","area::tabindex","area::target","audio::controls","audio::loop","audio::mediagroup","audio::muted","audio::preload","bdo::dir","blockquote::cite","br::clear","button::accesskey","button::disabled","button::name","button::onblur","button::onfocus","button::tabindex","button::type","button::value","canvas::height","canvas::width","caption::align","col::align","col::char","col::charoff","col::span","col::valign","col::width","colgroup::align","colgroup::char","colgroup::charoff","colgroup::span","colgroup::valign","colgroup::width","command::checked","command::command","command::disabled","command::icon","command::label","command::radiogroup","command::type","data::value","del::cite","del::datetime","details::open","dir::compact","div::align","dl::compact","fieldset::disabled","font::color","font::face","font::size","form::accept","form::action","form::autocomplete","form::enctype","form::method","form::name","form::novalidate","form::onreset","form::onsubmit","form::target","h1::align","h2::align","h3::align","h4::align","h5::align","h6::align","hr::align","hr::noshade","hr::size","hr::width","iframe::align","iframe::frameborder","iframe::height","iframe::marginheight","iframe::marginwidth","iframe::width","img::align","img::alt","img::border","img::height","img::hspace","img::ismap","img::name","img::src","img::usemap","img::vspace","img::width","input::accept","input::accesskey","input::align","input::alt","input::autocomplete","input::checked","input::disabled","input::inputmode","input::ismap","input::list","input::max","input::maxlength","input::min","input::multiple","input::name","input::onblur","input::onchange","input::onfocus","input::onselect","input::placeholder","input::readonly","input::required","input::size","input::src","input::step","input::tabindex","input::type","input::usemap","input::value","ins::cite","ins::datetime","label::accesskey","label::for","label::onblur","label::onfocus","legend::accesskey","legend::align","li::type","li::value","map::name","menu::compact","menu::label","menu::type","meter::high","meter::low","meter::max","meter::min","meter::value","ol::compact","ol::reversed","ol::start","ol::type","optgroup::disabled","optgroup::label","option::disabled","option::label","option::selected","option::value","output::for","output::name","p::align","pre::width","progress::max","progress::min","progress::value","q::cite","select::autocomplete","select::disabled","select::multiple","select::name","select::onblur","select::onchange","select::onfocus","select::required","select::size","select::tabindex","source::type","table::align","table::bgcolor","table::border","table::cellpadding","table::cellspacing","table::frame","table::rules","table::summary","table::width","tbody::align","tbody::char","tbody::charoff","tbody::valign","td::abbr","td::align","td::axis","td::bgcolor","td::char","td::charoff","td::colspan","td::headers","td::height","td::nowrap","td::rowspan","td::scope","td::valign","td::width","textarea::accesskey","textarea::autocomplete","textarea::cols","textarea::disabled","textarea::inputmode","textarea::name","textarea::onblur","textarea::onchange","textarea::onfocus","textarea::onselect","textarea::placeholder","textarea::readonly","textarea::required","textarea::rows","textarea::tabindex","textarea::wrap","tfoot::align","tfoot::char","tfoot::charoff","tfoot::valign","th::abbr","th::align","th::axis","th::bgcolor","th::char","th::charoff","th::colspan","th::headers","th::height","th::nowrap","th::rowspan","th::scope","th::valign","th::width","thead::align","thead::char","thead::charoff","thead::valign","tr::align","tr::bgcolor","tr::char","tr::charoff","tr::valign","track::default","track::kind","track::label","track::srclang","ul::compact","ul::type","video::controls","video::height","video::loop","video::mediagroup","video::muted","video::poster","video::preload","video::width","eflags","OPTIONAL_ENDTAG","EMPTY","CDATA","RCDATA","UNSAFE","FOLDABLE","VIRTUALIZED","ELEMENTS","a","abbr","acronym","address","applet","area","article","aside","audio","b","basefont","bdi","bdo","big","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","command","data","datalist","dd","del","details","dfn","dialog","dir","div","dl","dt","em","fieldset","figcaption","figure","font","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","iframe","img","input","ins","isindex","kbd","keygen","label","legend","li","link","map","mark","menu","meta","meter","nav","nobr","noembed","noframes","noscript","object","ol","optgroup","option","output","param","pre","progress","s","samp","script","section","select","small","source","span","strike","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","tt","u","ul","var","video","wbr","ELEMENT_DOM_INTERFACES","ueffects","NOT_LOADED","SAME_DOCUMENT","NEW_DOCUMENT","URIEFFECTS","ltypes","UNSANDBOXED","SANDBOXED","DATA","LOADERTYPES","lookupEntity","name","ENTITIES","hasOwnProperty","decimalEscapeRe","fromCharCode","parseInt","hexEscapeRe","entityLookupElement","safeEntityNameRe","innerHTML","text","textContent","decodeOneEntity","stripNULs","nulRe","unescapeEntities","ENTITY_RE_1","escapeAttrib","ampRe","ltRe","gtRe","quotRe","normalizeRCData","rcdata","looseAmpRe","makeSaxParser","handler","hcopy","cdata","comment","endDoc","endTag","pcdata","startDoc","startTag","htmlText","parseCPS","htmlSplit","noMoreGT","noMoreEndComments","continuationMaker","h","parts","initial","state","tagName","pos","end","current","next","ENTITY_RE_2","continuationMarker","exec","parseEndTag","EFLAGS_TEXT","tag","parseText","parseStartTag","substr","e","str","re","splitWillCapture","lastPos","index","parseTagAndAttrs","attrs","endTagRe","first","buf","ATTR_RE","quote","sawQuote","abuf","indexOf","aName","aValue","decodeValue","makeHtmlSanitizer","tagPolicy","stack","ignoring","emit","tagNameOrig","attribs","eflagsOrig","decision","eflagsRep","tagNameRep","onStack","orig","rep","attribName","stackElOrigTag","stackElRepTag","safeUri","effect","ltype","hints","naiveUriRewriter","parsed","ALLOWED_URI_SCHEMES","safe","log","logger","oldValue","newValue","change","changed","lookupAttribute","attribKey","getLoaderType","getUriEffect","sanitizeAttribs","opt_naiveUriRewriter","opt_nmTokenPolicy","opt_logger","parseCssDeclarations","sanitizedDeclarations","declaration","property","tokens","normProp","schema","cssSchema","sanitizeCssProperty","TYPE","CSS_PROP","XML_ATTR","XML_TAG","makeTagPolicy","sanitizeWithPolicy","inputHtml","outputArray","sanitize","lt","LT","gt","GT","amp","AMP","quot","apos","nbsp","createElement","global","factory","nodeName","define","amd","Mustache","mustache","isFunction","typeStr","obj","isArray","escapeRegExp","string","hasProperty","propName","primitiveHasOwnProperty","primitive","testRegExp","regExpTest","isWhitespace","nonSpaceRe","escapeHtml","entityMap","parseTemplate","template","tags","compileTags","tagsToCompile","spaceRe","openingTagRe","closingTagRe","closingCurlyRe","sections","spaces","hasTag","nonSpace","start","type","chr","token","openSection","scanner","Scanner","eos","scanUntil","valueLength","pop","scan","tagRe","whiteRe","equalsRe","curlyRe","nestTokens","squashTokens","lastToken","squashedTokens","numTokens","nestedTokens","collector","tail","Context","view","parentContext","cache",".","parent","Writer","objectToString","&","<",">","\"","'","/","`","=","search","lookup","intermediateValue","names","context","lookupHit","clearCache","cacheKey","render","partials","renderTokens","originalTemplate","symbol","buffer","renderSection","renderInverted","renderPartial","unescapedValue","escapedValue","rawValue","subRender","self","escape","version","defaultWriter","TypeError","to_html","result","HTTP_URL","HTTPS_URL","FORCE_HTTPS","REQUIRE_ACCESS_TOKEN","TEMPLATE_STYLES","mapbox.dark","mapbox.light","mapbox.osm-bright","mapbox.outdoors","mapbox.satellite","mapbox.streets","mapbox.streets-basic","mapbox.streets-satellite","util","format_url","request","marker","simplestyle","FeatureLayer","L","FeatureGroup","extend","options","filter","sanitizer","popupOptions","closeButton","initialize","setOptions","_layers","idUrl","setGeoJSON","_geojson","clearLayers","_initialize","getGeoJSON","loadURL","_request","abort","bind","err","json","fire","error","loadID","accessToken","setFilter","getFilter","len","features","Util","geometries","geometry","opts","pointToLayer","feature","latlon","layer","GeoJSON","geometryToLayer","popupHtml","createPopup","defaultStyle","Circle","CircleMarker","setStyle","bindPopup","addLayer","featureLayer","Feedback","Class","includes","Evented","Mixin","Events","record","config","mapbox","document","tileJSON","urlOrMapID","styleURL","ownerIDStyle","feedback","roundTo","latLng","precision","mult","Math","pow","lat","round","lng","geocoder","strict","getURL","queryURL","isObject","geocoding","types","country","bbox","proximity","autocomplete","res","results","latlng","bounds","lbounds","reverseQuery","normalize","lon","pts","GeocoderControl","Control","position","pointZoom","keepOpen","queryOptions","setURL","_updateSubmit","_updateAutocomplete","_chooseResult","setID","setTileJSON","_toggle","DomEvent","stop","DomUtil","hasClass","_container","removeClass","_results","_input","blur","addClass","focus","_closeIfOpen","onAdd","container","wrap","href","setAttribute","addListener","_geocode","_autocomplete","disableClickPropagation","_map","_form","on","resp","_displayResults","l","min","place_name","fitBounds","setView","getZoom","max","preventDefault","getCenter","geocoderControl","utfDecode","c","y","idx","grid","keys","GridControl","pinnable","follow","touchTeaser","_currentContent","_pinned","strict_instance","_layer","setTemplate","_template","format","getTileJSON","d","_show","content","o","_popup","setContent","setLatLng","openOn","display","_contentWrapper","hide","closePopup","_mouseover","_mousemove","_navigateTo","top","_click","location_formatted","Browser","touch","_onPopupClose","_createClosebutton","fn","stopPropagation","contentWrapper","appendChild","Popup","autoPan","closeOnClick","onRemove","off","gridControl","GridLayer","Layer","_mouseOn","_tilejson","_cache","_loadTileJSON","_setTileJSON","grids","minZoom","minzoom","maxZoom","maxzoom","_update","active","_move","getData","point","project","floor","crs","scale","_getTile","gridX","gridY","_getTileURL","tilePoint","urls","getPixelBounds","z","tileBounds","divideBy","_floor","_tileShouldBeLoaded","callbacks","nwPoint","multiplyBy","sePoint","add","Point","nw","unproject","se","LatLngBounds","intersects","gridLayer","LegendControl","_legends","addLegend","removeLegend","legendControl","isGLStyle","warn","tiles","owner","withAccessToken","tileLayer","shareControl","mapboxLogoControl","LMap","Map","element","attributionControl","setPrefix","compact","offsetWidth","addControl","_mapboxLogoControl","_onLayerAdd","_onLayerRemove","_updateMapFeedbackLink","whenReady","_updateLayer","_loaded","defaultZoom","zoom","_controlContainer","getElementsByClassName","tilejson","hash","toFixed","_onLayerReady","target","getAttribution","addAttribution","stamp","_zoomBoundLayers","getContainer","_updateZoomLevels","styleLayer","VERSION","TileLayer","StyleLayer","ShareControl","Icon","Default","imagePath","MapboxLogoControl","mapbox_logo","icon","fp","sizes","medium","large","size","color","iconUrl","retina","iconSize","iconAnchor","popupAnchor","f","properties","strip_tags","popup","description","JSON","responseText","_modal","_mask","_content","_shareClick","_clickOut","_sharing","createShareButton","buttonClass","socialMediaName","elem","createTextNode","webpage","image","embed","twitterURL","facebookURL","pinterestURL","embedValue","twitterButton","facebookButton","pinterestButton","shareHeader","shareText","shareButtons","close","fallback","remap","mapping","defaults","stroke","stroke-width","stroke-opacity","fill","fill-opacity","tileSize","zoomOffset","minNativeZoom","tms","_url","_formatTileURL","_getAttribution","sources","attribution","setUrl","formatPattern","formats","scalePrefix","strict_oneof","setFormat","redraw","getTileUrl","abs","templated","contains","item","list","warnOnceHistory","t","console","klass"],"mappings":"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","file":"bundle.js","sourcesContent":["(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c=\"function\"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error(\"Cannot find module '\"+i+\"'\");throw a.code=\"MODULE_NOT_FOUND\",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u=\"function\"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()","module.exports={\"author\":\"Mapbox\",\"name\":\"mapbox.js\",\"description\":\"Mapbox plugin for Leaflet\",\"version\":\"3.3.1\",\"homepage\":\"http://mapbox.com/\",\"engines\":{\"node\":\">=10\"},\"repository\":{\"type\":\"git\",\"url\":\"git://github.com/mapbox/mapbox.js.git\"},\"main\":\"src/index.js\",\"files\":[\"dist\",\"src\",\"*.md\"],\"dependencies\":{\"@mapbox/corslite\":\"0.0.7\",\"@mapbox/sanitize-caja\":\"^0.1.4\",\"leaflet\":\"1.4.0\",\"mustache\":\"3.0.1\"},\"scripts\":{\"test\":\"eslint src && phantomjs node_modules/mocha-phantomjs-core/mocha-phantomjs-core.js test/index.html && mocha test/docs.js\",\"prepublishOnly\":\"npm run build\",\"build\":\"make\"},\"license\":\"BSD-3-Clause\",\"devDependencies\":{\"browserify\":\"^16.5.0\",\"clean-css-cli\":\"^4.3.0\",\"eslint\":\"^6.8.0\",\"expect.js\":\"0.3.1\",\"happen\":\"0.3.2\",\"marked\":\"^0.8.0\",\"minifyify\":\"^7.3.5\",\"minimist\":\"1.2.0\",\"mocha\":\"^7.0.1\",\"mocha-phantomjs-core\":\"2.1.2\",\"phantomjs-prebuilt\":\"2.1.16\",\"sinon\":\"7.2.4\"},\"optionalDependencies\":{}}","function corslite(url, callback, cors) {\n    var sent = false;\n\n    if (typeof window.XMLHttpRequest === 'undefined') {\n        return callback(Error('Browser not supported'));\n    }\n\n    if (typeof cors === 'undefined') {\n        var m = url.match(/^\\s*https?:\\/\\/[^\\/]*/);\n        cors = m && (m[0] !== location.protocol + '//' + location.hostname +\n                (location.port ? ':' + location.port : ''));\n    }\n\n    var x = new window.XMLHttpRequest();\n\n    function isSuccessful(status) {\n        return status >= 200 && status < 300 || status === 304;\n    }\n\n    if (cors && !('withCredentials' in x)) {\n        // IE8-9\n        x = new window.XDomainRequest();\n\n        // Ensure callback is never called synchronously, i.e., before\n        // x.send() returns (this has been observed in the wild).\n        // See https://github.com/mapbox/mapbox.js/issues/472\n        var original = callback;\n        callback = function() {\n            if (sent) {\n                original.apply(this, arguments);\n            } else {\n                var that = this, args = arguments;\n                setTimeout(function() {\n                    original.apply(that, args);\n                }, 0);\n            }\n        }\n    }\n\n    function loaded() {\n        if (\n            // XDomainRequest\n            x.status === undefined ||\n            // modern browsers\n            isSuccessful(x.status)) callback.call(x, null, x);\n        else callback.call(x, x, null);\n    }\n\n    // Both `onreadystatechange` and `onload` can fire. `onreadystatechange`\n    // has [been supported for longer](http://stackoverflow.com/a/9181508/229001).\n    if ('onload' in x) {\n        x.onload = loaded;\n    } else {\n        x.onreadystatechange = function readystate() {\n            if (x.readyState === 4) {\n                loaded();\n            }\n        };\n    }\n\n    // Call the callback with the XMLHttpRequest object as an error and prevent\n    // it from ever being called again by reassigning it to `noop`\n    x.onerror = function error(evt) {\n        // XDomainRequest provides no evt parameter\n        callback.call(this, evt || true, null);\n        callback = function() { };\n    };\n\n    // IE9 must have onprogress be set to a unique function.\n    x.onprogress = function() { };\n\n    x.ontimeout = function(evt) {\n        callback.call(this, evt, null);\n        callback = function() { };\n    };\n\n    x.onabort = function(evt) {\n        callback.call(this, evt, null);\n        callback = function() { };\n    };\n\n    // GET is the only supported HTTP Verb by XDomainRequest and is the\n    // only one supported here.\n    x.open('GET', url, true);\n\n    // Send the request. Sending data is not supported.\n    x.send(null);\n    sent = true;\n\n    return x;\n}\n\nif (typeof module !== 'undefined') module.exports = corslite;\n","var html_sanitize = require('./sanitizer-bundle.js');\n\nmodule.exports = function(_) {\n    if (!_) return '';\n    return html_sanitize(_, cleanUrl, cleanId);\n};\n\n// https://bugzilla.mozilla.org/show_bug.cgi?id=255107\nfunction cleanUrl(url) {\n    'use strict';\n    if (/^https?/.test(url.getScheme())) return url.toString();\n    if (/^mailto?/.test(url.getScheme())) return url.toString();\n    if ('data' == url.getScheme() && /^image/.test(url.getPath())) {\n        return url.toString();\n    }\n}\n\nfunction cleanId(id) { return id; }\n","\n// Copyright (C) 2010 Google Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview\n * Implements RFC 3986 for parsing/formatting URIs.\n *\n * @author mikesamuel@gmail.com\n * \\@provides URI\n * \\@overrides window\n */\n\nvar URI = (function () {\n\n/**\n * creates a uri from the string form.  The parser is relaxed, so special\n * characters that aren't escaped but don't cause ambiguities will not cause\n * parse failures.\n *\n * @return {URI|null}\n */\nfunction parse(uriStr) {\n  var m = ('' + uriStr).match(URI_RE_);\n  if (!m) { return null; }\n  return new URI(\n      nullIfAbsent(m[1]),\n      nullIfAbsent(m[2]),\n      nullIfAbsent(m[3]),\n      nullIfAbsent(m[4]),\n      nullIfAbsent(m[5]),\n      nullIfAbsent(m[6]),\n      nullIfAbsent(m[7]));\n}\n\n\n/**\n * creates a uri from the given parts.\n *\n * @param scheme {string} an unencoded scheme such as \"http\" or null\n * @param credentials {string} unencoded user credentials or null\n * @param domain {string} an unencoded domain name or null\n * @param port {number} a port number in [1, 32768].\n *    -1 indicates no port, as does null.\n * @param path {string} an unencoded path\n * @param query {Array.<string>|string|null} a list of unencoded cgi\n *   parameters where even values are keys and odds the corresponding values\n *   or an unencoded query.\n * @param fragment {string} an unencoded fragment without the \"#\" or null.\n * @return {URI}\n */\nfunction create(scheme, credentials, domain, port, path, query, fragment) {\n  var uri = new URI(\n      encodeIfExists2(scheme, URI_DISALLOWED_IN_SCHEME_OR_CREDENTIALS_),\n      encodeIfExists2(\n          credentials, URI_DISALLOWED_IN_SCHEME_OR_CREDENTIALS_),\n      encodeIfExists(domain),\n      port > 0 ? port.toString() : null,\n      encodeIfExists2(path, URI_DISALLOWED_IN_PATH_),\n      null,\n      encodeIfExists(fragment));\n  if (query) {\n    if ('string' === typeof query) {\n      uri.setRawQuery(query.replace(/[^?&=0-9A-Za-z_\\-~.%]/g, encodeOne));\n    } else {\n      uri.setAllParameters(query);\n    }\n  }\n  return uri;\n}\nfunction encodeIfExists(unescapedPart) {\n  if ('string' == typeof unescapedPart) {\n    return encodeURIComponent(unescapedPart);\n  }\n  return null;\n};\n/**\n * if unescapedPart is non null, then escapes any characters in it that aren't\n * valid characters in a url and also escapes any special characters that\n * appear in extra.\n *\n * @param unescapedPart {string}\n * @param extra {RegExp} a character set of characters in [\\01-\\177].\n * @return {string|null} null iff unescapedPart == null.\n */\nfunction encodeIfExists2(unescapedPart, extra) {\n  if ('string' == typeof unescapedPart) {\n    return encodeURI(unescapedPart).replace(extra, encodeOne);\n  }\n  return null;\n};\n/** converts a character in [\\01-\\177] to its url encoded equivalent. */\nfunction encodeOne(ch) {\n  var n = ch.charCodeAt(0);\n  return '%' + '0123456789ABCDEF'.charAt((n >> 4) & 0xf) +\n      '0123456789ABCDEF'.charAt(n & 0xf);\n}\n\n/**\n * {@updoc\n *  $ normPath('foo/./bar')\n *  # 'foo/bar'\n *  $ normPath('./foo')\n *  # 'foo'\n *  $ normPath('foo/.')\n *  # 'foo'\n *  $ normPath('foo//bar')\n *  # 'foo/bar'\n * }\n */\nfunction normPath(path) {\n  return path.replace(/(^|\\/)\\.(?:\\/|$)/g, '$1').replace(/\\/{2,}/g, '/');\n}\n\nvar PARENT_DIRECTORY_HANDLER = new RegExp(\n    ''\n    // A path break\n    + '(/|^)'\n    // followed by a non .. path element\n    // (cannot be . because normPath is used prior to this RegExp)\n    + '(?:[^./][^/]*|\\\\.{2,}(?:[^./][^/]*)|\\\\.{3,}[^/]*)'\n    // followed by .. followed by a path break.\n    + '/\\\\.\\\\.(?:/|$)');\n\nvar PARENT_DIRECTORY_HANDLER_RE = new RegExp(PARENT_DIRECTORY_HANDLER);\n\nvar EXTRA_PARENT_PATHS_RE = /^(?:\\.\\.\\/)*(?:\\.\\.$)?/;\n\n/**\n * Normalizes its input path and collapses all . and .. sequences except for\n * .. sequences that would take it above the root of the current parent\n * directory.\n * {@updoc\n *  $ collapse_dots('foo/../bar')\n *  # 'bar'\n *  $ collapse_dots('foo/./bar')\n *  # 'foo/bar'\n *  $ collapse_dots('foo/../bar/./../../baz')\n *  # 'baz'\n *  $ collapse_dots('../foo')\n *  # '../foo'\n *  $ collapse_dots('../foo').replace(EXTRA_PARENT_PATHS_RE, '')\n *  # 'foo'\n * }\n */\nfunction collapse_dots(path) {\n  if (path === null) { return null; }\n  var p = normPath(path);\n  // Only /../ left to flatten\n  var r = PARENT_DIRECTORY_HANDLER_RE;\n  // We replace with $1 which matches a / before the .. because this\n  // guarantees that:\n  // (1) we have at most 1 / between the adjacent place,\n  // (2) always have a slash if there is a preceding path section, and\n  // (3) we never turn a relative path into an absolute path.\n  for (var q; (q = p.replace(r, '$1')) != p; p = q) {};\n  return p;\n}\n\n/**\n * resolves a relative url string to a base uri.\n * @return {URI}\n */\nfunction resolve(baseUri, relativeUri) {\n  // there are several kinds of relative urls:\n  // 1. //foo - replaces everything from the domain on.  foo is a domain name\n  // 2. foo - replaces the last part of the path, the whole query and fragment\n  // 3. /foo - replaces the the path, the query and fragment\n  // 4. ?foo - replace the query and fragment\n  // 5. #foo - replace the fragment only\n\n  var absoluteUri = baseUri.clone();\n  // we satisfy these conditions by looking for the first part of relativeUri\n  // that is not blank and applying defaults to the rest\n\n  var overridden = relativeUri.hasScheme();\n\n  if (overridden) {\n    absoluteUri.setRawScheme(relativeUri.getRawScheme());\n  } else {\n    overridden = relativeUri.hasCredentials();\n  }\n\n  if (overridden) {\n    absoluteUri.setRawCredentials(relativeUri.getRawCredentials());\n  } else {\n    overridden = relativeUri.hasDomain();\n  }\n\n  if (overridden) {\n    absoluteUri.setRawDomain(relativeUri.getRawDomain());\n  } else {\n    overridden = relativeUri.hasPort();\n  }\n\n  var rawPath = relativeUri.getRawPath();\n  var simplifiedPath = collapse_dots(rawPath);\n  if (overridden) {\n    absoluteUri.setPort(relativeUri.getPort());\n    simplifiedPath = simplifiedPath\n        && simplifiedPath.replace(EXTRA_PARENT_PATHS_RE, '');\n  } else {\n    overridden = !!rawPath;\n    if (overridden) {\n      // resolve path properly\n      if (simplifiedPath.charCodeAt(0) !== 0x2f /* / */) {  // path is relative\n        var absRawPath = collapse_dots(absoluteUri.getRawPath() || '')\n            .replace(EXTRA_PARENT_PATHS_RE, '');\n        var slash = absRawPath.lastIndexOf('/') + 1;\n        simplifiedPath = collapse_dots(\n            (slash ? absRawPath.substring(0, slash) : '')\n            + collapse_dots(rawPath))\n            .replace(EXTRA_PARENT_PATHS_RE, '');\n      }\n    } else {\n      simplifiedPath = simplifiedPath\n          && simplifiedPath.replace(EXTRA_PARENT_PATHS_RE, '');\n      if (simplifiedPath !== rawPath) {\n        absoluteUri.setRawPath(simplifiedPath);\n      }\n    }\n  }\n\n  if (overridden) {\n    absoluteUri.setRawPath(simplifiedPath);\n  } else {\n    overridden = relativeUri.hasQuery();\n  }\n\n  if (overridden) {\n    absoluteUri.setRawQuery(relativeUri.getRawQuery());\n  } else {\n    overridden = relativeUri.hasFragment();\n  }\n\n  if (overridden) {\n    absoluteUri.setRawFragment(relativeUri.getRawFragment());\n  }\n\n  return absoluteUri;\n}\n\n/**\n * a mutable URI.\n *\n * This class contains setters and getters for the parts of the URI.\n * The <tt>getXYZ</tt>/<tt>setXYZ</tt> methods return the decoded part -- so\n * <code>uri.parse('/foo%20bar').getPath()</code> will return the decoded path,\n * <tt>/foo bar</tt>.\n *\n * <p>The raw versions of fields are available too.\n * <code>uri.parse('/foo%20bar').getRawPath()</code> will return the raw path,\n * <tt>/foo%20bar</tt>.  Use the raw setters with care, since\n * <code>URI::toString</code> is not guaranteed to return a valid url if a\n * raw setter was used.\n *\n * <p>All setters return <tt>this</tt> and so may be chained, a la\n * <code>uri.parse('/foo').setFragment('part').toString()</code>.\n *\n * <p>You should not use this constructor directly -- please prefer the factory\n * functions {@link uri.parse}, {@link uri.create}, {@link uri.resolve}\n * instead.</p>\n *\n * <p>The parameters are all raw (assumed to be properly escaped) parts, and\n * any (but not all) may be null.  Undefined is not allowed.</p>\n *\n * @constructor\n */\nfunction URI(\n    rawScheme,\n    rawCredentials, rawDomain, port,\n    rawPath, rawQuery, rawFragment) {\n  this.scheme_ = rawScheme;\n  this.credentials_ = rawCredentials;\n  this.domain_ = rawDomain;\n  this.port_ = port;\n  this.path_ = rawPath;\n  this.query_ = rawQuery;\n  this.fragment_ = rawFragment;\n  /**\n   * @type {Array|null}\n   */\n  this.paramCache_ = null;\n}\n\n/** returns the string form of the url. */\nURI.prototype.toString = function () {\n  var out = [];\n  if (null !== this.scheme_) { out.push(this.scheme_, ':'); }\n  if (null !== this.domain_) {\n    out.push('//');\n    if (null !== this.credentials_) { out.push(this.credentials_, '@'); }\n    out.push(this.domain_);\n    if (null !== this.port_) { out.push(':', this.port_.toString()); }\n  }\n  if (null !== this.path_) { out.push(this.path_); }\n  if (null !== this.query_) { out.push('?', this.query_); }\n  if (null !== this.fragment_) { out.push('#', this.fragment_); }\n  return out.join('');\n};\n\nURI.prototype.clone = function () {\n  return new URI(this.scheme_, this.credentials_, this.domain_, this.port_,\n                 this.path_, this.query_, this.fragment_);\n};\n\nURI.prototype.getScheme = function () {\n  // HTML5 spec does not require the scheme to be lowercased but\n  // all common browsers except Safari lowercase the scheme.\n  return this.scheme_ && decodeURIComponent(this.scheme_).toLowerCase();\n};\nURI.prototype.getRawScheme = function () {\n  return this.scheme_;\n};\nURI.prototype.setScheme = function (newScheme) {\n  this.scheme_ = encodeIfExists2(\n      newScheme, URI_DISALLOWED_IN_SCHEME_OR_CREDENTIALS_);\n  return this;\n};\nURI.prototype.setRawScheme = function (newScheme) {\n  this.scheme_ = newScheme ? newScheme : null;\n  return this;\n};\nURI.prototype.hasScheme = function () {\n  return null !== this.scheme_;\n};\n\n\nURI.prototype.getCredentials = function () {\n  return this.credentials_ && decodeURIComponent(this.credentials_);\n};\nURI.prototype.getRawCredentials = function () {\n  return this.credentials_;\n};\nURI.prototype.setCredentials = function (newCredentials) {\n  this.credentials_ = encodeIfExists2(\n      newCredentials, URI_DISALLOWED_IN_SCHEME_OR_CREDENTIALS_);\n\n  return this;\n};\nURI.prototype.setRawCredentials = function (newCredentials) {\n  this.credentials_ = newCredentials ? newCredentials : null;\n  return this;\n};\nURI.prototype.hasCredentials = function () {\n  return null !== this.credentials_;\n};\n\n\nURI.prototype.getDomain = function () {\n  return this.domain_ && decodeURIComponent(this.domain_);\n};\nURI.prototype.getRawDomain = function () {\n  return this.domain_;\n};\nURI.prototype.setDomain = function (newDomain) {\n  return this.setRawDomain(newDomain && encodeURIComponent(newDomain));\n};\nURI.prototype.setRawDomain = function (newDomain) {\n  this.domain_ = newDomain ? newDomain : null;\n  // Maintain the invariant that paths must start with a slash when the URI\n  // is not path-relative.\n  return this.setRawPath(this.path_);\n};\nURI.prototype.hasDomain = function () {\n  return null !== this.domain_;\n};\n\n\nURI.prototype.getPort = function () {\n  return this.port_ && decodeURIComponent(this.port_);\n};\nURI.prototype.setPort = function (newPort) {\n  if (newPort) {\n    newPort = Number(newPort);\n    if (newPort !== (newPort & 0xffff)) {\n      throw new Error('Bad port number ' + newPort);\n    }\n    this.port_ = '' + newPort;\n  } else {\n    this.port_ = null;\n  }\n  return this;\n};\nURI.prototype.hasPort = function () {\n  return null !== this.port_;\n};\n\n\nURI.prototype.getPath = function () {\n  return this.path_ && decodeURIComponent(this.path_);\n};\nURI.prototype.getRawPath = function () {\n  return this.path_;\n};\nURI.prototype.setPath = function (newPath) {\n  return this.setRawPath(encodeIfExists2(newPath, URI_DISALLOWED_IN_PATH_));\n};\nURI.prototype.setRawPath = function (newPath) {\n  if (newPath) {\n    newPath = String(newPath);\n    this.path_ = \n      // Paths must start with '/' unless this is a path-relative URL.\n      (!this.domain_ || /^\\//.test(newPath)) ? newPath : '/' + newPath;\n  } else {\n    this.path_ = null;\n  }\n  return this;\n};\nURI.prototype.hasPath = function () {\n  return null !== this.path_;\n};\n\n\nURI.prototype.getQuery = function () {\n  // From http://www.w3.org/Addressing/URL/4_URI_Recommentations.html\n  // Within the query string, the plus sign is reserved as shorthand notation\n  // for a space.\n  return this.query_ && decodeURIComponent(this.query_).replace(/\\+/g, ' ');\n};\nURI.prototype.getRawQuery = function () {\n  return this.query_;\n};\nURI.prototype.setQuery = function (newQuery) {\n  this.paramCache_ = null;\n  this.query_ = encodeIfExists(newQuery);\n  return this;\n};\nURI.prototype.setRawQuery = function (newQuery) {\n  this.paramCache_ = null;\n  this.query_ = newQuery ? newQuery : null;\n  return this;\n};\nURI.prototype.hasQuery = function () {\n  return null !== this.query_;\n};\n\n/**\n * sets the query given a list of strings of the form\n * [ key0, value0, key1, value1, ... ].\n *\n * <p><code>uri.setAllParameters(['a', 'b', 'c', 'd']).getQuery()</code>\n * will yield <code>'a=b&c=d'</code>.\n */\nURI.prototype.setAllParameters = function (params) {\n  if (typeof params === 'object') {\n    if (!(params instanceof Array)\n        && (params instanceof Object\n            || Object.prototype.toString.call(params) !== '[object Array]')) {\n      var newParams = [];\n      var i = -1;\n      for (var k in params) {\n        var v = params[k];\n        if ('string' === typeof v) {\n          newParams[++i] = k;\n          newParams[++i] = v;\n        }\n      }\n      params = newParams;\n    }\n  }\n  this.paramCache_ = null;\n  var queryBuf = [];\n  var separator = '';\n  for (var j = 0; j < params.length;) {\n    var k = params[j++];\n    var v = params[j++];\n    queryBuf.push(separator, encodeURIComponent(k.toString()));\n    separator = '&';\n    if (v) {\n      queryBuf.push('=', encodeURIComponent(v.toString()));\n    }\n  }\n  this.query_ = queryBuf.join('');\n  return this;\n};\nURI.prototype.checkParameterCache_ = function () {\n  if (!this.paramCache_) {\n    var q = this.query_;\n    if (!q) {\n      this.paramCache_ = [];\n    } else {\n      var cgiParams = q.split(/[&\\?]/);\n      var out = [];\n      var k = -1;\n      for (var i = 0; i < cgiParams.length; ++i) {\n        var m = cgiParams[i].match(/^([^=]*)(?:=(.*))?$/);\n        // From http://www.w3.org/Addressing/URL/4_URI_Recommentations.html\n        // Within the query string, the plus sign is reserved as shorthand\n        // notation for a space.\n        out[++k] = decodeURIComponent(m[1]).replace(/\\+/g, ' ');\n        out[++k] = decodeURIComponent(m[2] || '').replace(/\\+/g, ' ');\n      }\n      this.paramCache_ = out;\n    }\n  }\n};\n/**\n * sets the values of the named cgi parameters.\n *\n * <p>So, <code>uri.parse('foo?a=b&c=d&e=f').setParameterValues('c', ['new'])\n * </code> yields <tt>foo?a=b&c=new&e=f</tt>.</p>\n *\n * @param key {string}\n * @param values {Array.<string>} the new values.  If values is a single string\n *   then it will be treated as the sole value.\n */\nURI.prototype.setParameterValues = function (key, values) {\n  // be nice and avoid subtle bugs where [] operator on string performs charAt\n  // on some browsers and crashes on IE\n  if (typeof values === 'string') {\n    values = [ values ];\n  }\n\n  this.checkParameterCache_();\n  var newValueIndex = 0;\n  var pc = this.paramCache_;\n  var params = [];\n  for (var i = 0, k = 0; i < pc.length; i += 2) {\n    if (key === pc[i]) {\n      if (newValueIndex < values.length) {\n        params.push(key, values[newValueIndex++]);\n      }\n    } else {\n      params.push(pc[i], pc[i + 1]);\n    }\n  }\n  while (newValueIndex < values.length) {\n    params.push(key, values[newValueIndex++]);\n  }\n  this.setAllParameters(params);\n  return this;\n};\nURI.prototype.removeParameter = function (key) {\n  return this.setParameterValues(key, []);\n};\n/**\n * returns the parameters specified in the query part of the uri as a list of\n * keys and values like [ key0, value0, key1, value1, ... ].\n *\n * @return {Array.<string>}\n */\nURI.prototype.getAllParameters = function () {\n  this.checkParameterCache_();\n  return this.paramCache_.slice(0, this.paramCache_.length);\n};\n/**\n * returns the value<b>s</b> for a given cgi parameter as a list of decoded\n * query parameter values.\n * @return {Array.<string>}\n */\nURI.prototype.getParameterValues = function (paramNameUnescaped) {\n  this.checkParameterCache_();\n  var values = [];\n  for (var i = 0; i < this.paramCache_.length; i += 2) {\n    if (paramNameUnescaped === this.paramCache_[i]) {\n      values.push(this.paramCache_[i + 1]);\n    }\n  }\n  return values;\n};\n/**\n * returns a map of cgi parameter names to (non-empty) lists of values.\n * @return {Object.<string,Array.<string>>}\n */\nURI.prototype.getParameterMap = function (paramNameUnescaped) {\n  this.checkParameterCache_();\n  var paramMap = {};\n  for (var i = 0; i < this.paramCache_.length; i += 2) {\n    var key = this.paramCache_[i++],\n      value = this.paramCache_[i++];\n    if (!(key in paramMap)) {\n      paramMap[key] = [value];\n    } else {\n      paramMap[key].push(value);\n    }\n  }\n  return paramMap;\n};\n/**\n * returns the first value for a given cgi parameter or null if the given\n * parameter name does not appear in the query string.\n * If the given parameter name does appear, but has no '<tt>=</tt>' following\n * it, then the empty string will be returned.\n * @return {string|null}\n */\nURI.prototype.getParameterValue = function (paramNameUnescaped) {\n  this.checkParameterCache_();\n  for (var i = 0; i < this.paramCache_.length; i += 2) {\n    if (paramNameUnescaped === this.paramCache_[i]) {\n      return this.paramCache_[i + 1];\n    }\n  }\n  return null;\n};\n\nURI.prototype.getFragment = function () {\n  return this.fragment_ && decodeURIComponent(this.fragment_);\n};\nURI.prototype.getRawFragment = function () {\n  return this.fragment_;\n};\nURI.prototype.setFragment = function (newFragment) {\n  this.fragment_ = newFragment ? encodeURIComponent(newFragment) : null;\n  return this;\n};\nURI.prototype.setRawFragment = function (newFragment) {\n  this.fragment_ = newFragment ? newFragment : null;\n  return this;\n};\nURI.prototype.hasFragment = function () {\n  return null !== this.fragment_;\n};\n\nfunction nullIfAbsent(matchPart) {\n  return ('string' == typeof matchPart) && (matchPart.length > 0)\n         ? matchPart\n         : null;\n}\n\n\n\n\n/**\n * a regular expression for breaking a URI into its component parts.\n *\n * <p>http://www.gbiv.com/protocols/uri/rfc/rfc3986.html#RFC2234 says\n * As the \"first-match-wins\" algorithm is identical to the \"greedy\"\n * disambiguation method used by POSIX regular expressions, it is natural and\n * commonplace to use a regular expression for parsing the potential five\n * components of a URI reference.\n *\n * <p>The following line is the regular expression for breaking-down a\n * well-formed URI reference into its components.\n *\n * <pre>\n * ^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?\n *  12            3  4          5       6  7        8 9\n * </pre>\n *\n * <p>The numbers in the second line above are only to assist readability; they\n * indicate the reference points for each subexpression (i.e., each paired\n * parenthesis). We refer to the value matched for subexpression <n> as $<n>.\n * For example, matching the above expression to\n * <pre>\n *     http://www.ics.uci.edu/pub/ietf/uri/#Related\n * </pre>\n * results in the following subexpression matches:\n * <pre>\n *    $1 = http:\n *    $2 = http\n *    $3 = //www.ics.uci.edu\n *    $4 = www.ics.uci.edu\n *    $5 = /pub/ietf/uri/\n *    $6 = <undefined>\n *    $7 = <undefined>\n *    $8 = #Related\n *    $9 = Related\n * </pre>\n * where <undefined> indicates that the component is not present, as is the\n * case for the query component in the above example. Therefore, we can\n * determine the value of the five components as\n * <pre>\n *    scheme    = $2\n *    authority = $4\n *    path      = $5\n *    query     = $7\n *    fragment  = $9\n * </pre>\n *\n * <p>msamuel: I have modified the regular expression slightly to expose the\n * credentials, domain, and port separately from the authority.\n * The modified version yields\n * <pre>\n *    $1 = http              scheme\n *    $2 = <undefined>       credentials -\\\n *    $3 = www.ics.uci.edu   domain       | authority\n *    $4 = <undefined>       port        -/\n *    $5 = /pub/ietf/uri/    path\n *    $6 = <undefined>       query without ?\n *    $7 = Related           fragment without #\n * </pre>\n */\nvar URI_RE_ = new RegExp(\n      \"^\" +\n      \"(?:\" +\n        \"([^:/?#]+)\" +         // scheme\n      \":)?\" +\n      \"(?://\" +\n        \"(?:([^/?#]*)@)?\" +    // credentials\n        \"([^/?#:@]*)\" +        // domain\n        \"(?::([0-9]+))?\" +     // port\n      \")?\" +\n      \"([^?#]+)?\" +            // path\n      \"(?:\\\\?([^#]*))?\" +      // query\n      \"(?:#(.*))?\" +           // fragment\n      \"$\"\n      );\n\nvar URI_DISALLOWED_IN_SCHEME_OR_CREDENTIALS_ = /[#\\/\\?@]/g;\nvar URI_DISALLOWED_IN_PATH_ = /[\\#\\?]/g;\n\nURI.parse = parse;\nURI.create = create;\nURI.resolve = resolve;\nURI.collapse_dots = collapse_dots;  // Visible for testing.\n\n// lightweight string-based api for loadModuleMaker\nURI.utils = {\n  mimeTypeOf: function (uri) {\n    var uriObj = parse(uri);\n    if (/\\.html$/.test(uriObj.getPath())) {\n      return 'text/html';\n    } else {\n      return 'application/javascript';\n    }\n  },\n  resolve: function (base, uri) {\n    if (base) {\n      return resolve(parse(base), parse(uri)).toString();\n    } else {\n      return '' + uri;\n    }\n  }\n};\n\n\nreturn URI;\n})();\n\n// Copyright Google Inc.\n// Licensed under the Apache Licence Version 2.0\n// Autogenerated at Mon Feb 25 13:05:42 EST 2013\n// @overrides window\n// @provides html4\nvar html4 = {};\nhtml4.atype = {\n  'NONE': 0,\n  'URI': 1,\n  'URI_FRAGMENT': 11,\n  'SCRIPT': 2,\n  'STYLE': 3,\n  'HTML': 12,\n  'ID': 4,\n  'IDREF': 5,\n  'IDREFS': 6,\n  'GLOBAL_NAME': 7,\n  'LOCAL_NAME': 8,\n  'CLASSES': 9,\n  'FRAME_TARGET': 10,\n  'MEDIA_QUERY': 13\n};\nhtml4[ 'atype' ] = html4.atype;\nhtml4.ATTRIBS = {\n  '*::class': 9,\n  '*::dir': 0,\n  '*::draggable': 0,\n  '*::hidden': 0,\n  '*::id': 4,\n  '*::inert': 0,\n  '*::itemprop': 0,\n  '*::itemref': 6,\n  '*::itemscope': 0,\n  '*::lang': 0,\n  '*::onblur': 2,\n  '*::onchange': 2,\n  '*::onclick': 2,\n  '*::ondblclick': 2,\n  '*::onfocus': 2,\n  '*::onkeydown': 2,\n  '*::onkeypress': 2,\n  '*::onkeyup': 2,\n  '*::onload': 2,\n  '*::onmousedown': 2,\n  '*::onmousemove': 2,\n  '*::onmouseout': 2,\n  '*::onmouseover': 2,\n  '*::onmouseup': 2,\n  '*::onreset': 2,\n  '*::onscroll': 2,\n  '*::onselect': 2,\n  '*::onsubmit': 2,\n  '*::onunload': 2,\n  '*::spellcheck': 0,\n  '*::style': 3,\n  '*::title': 0,\n  '*::translate': 0,\n  'a::accesskey': 0,\n  'a::coords': 0,\n  'a::href': 1,\n  'a::hreflang': 0,\n  'a::name': 7,\n  'a::onblur': 2,\n  'a::onfocus': 2,\n  'a::shape': 0,\n  'a::tabindex': 0,\n  'a::target': 10,\n  'a::type': 0,\n  'area::accesskey': 0,\n  'area::alt': 0,\n  'area::coords': 0,\n  'area::href': 1,\n  'area::nohref': 0,\n  'area::onblur': 2,\n  'area::onfocus': 2,\n  'area::shape': 0,\n  'area::tabindex': 0,\n  'area::target': 10,\n  'audio::controls': 0,\n  'audio::loop': 0,\n  'audio::mediagroup': 5,\n  'audio::muted': 0,\n  'audio::preload': 0,\n  'bdo::dir': 0,\n  'blockquote::cite': 1,\n  'br::clear': 0,\n  'button::accesskey': 0,\n  'button::disabled': 0,\n  'button::name': 8,\n  'button::onblur': 2,\n  'button::onfocus': 2,\n  'button::tabindex': 0,\n  'button::type': 0,\n  'button::value': 0,\n  'canvas::height': 0,\n  'canvas::width': 0,\n  'caption::align': 0,\n  'col::align': 0,\n  'col::char': 0,\n  'col::charoff': 0,\n  'col::span': 0,\n  'col::valign': 0,\n  'col::width': 0,\n  'colgroup::align': 0,\n  'colgroup::char': 0,\n  'colgroup::charoff': 0,\n  'colgroup::span': 0,\n  'colgroup::valign': 0,\n  'colgroup::width': 0,\n  'command::checked': 0,\n  'command::command': 5,\n  'command::disabled': 0,\n  'command::icon': 1,\n  'command::label': 0,\n  'command::radiogroup': 0,\n  'command::type': 0,\n  'data::value': 0,\n  'del::cite': 1,\n  'del::datetime': 0,\n  'details::open': 0,\n  'dir::compact': 0,\n  'div::align': 0,\n  'dl::compact': 0,\n  'fieldset::disabled': 0,\n  'font::color': 0,\n  'font::face': 0,\n  'font::size': 0,\n  'form::accept': 0,\n  'form::action': 1,\n  'form::autocomplete': 0,\n  'form::enctype': 0,\n  'form::method': 0,\n  'form::name': 7,\n  'form::novalidate': 0,\n  'form::onreset': 2,\n  'form::onsubmit': 2,\n  'form::target': 10,\n  'h1::align': 0,\n  'h2::align': 0,\n  'h3::align': 0,\n  'h4::align': 0,\n  'h5::align': 0,\n  'h6::align': 0,\n  'hr::align': 0,\n  'hr::noshade': 0,\n  'hr::size': 0,\n  'hr::width': 0,\n  'iframe::align': 0,\n  'iframe::frameborder': 0,\n  'iframe::height': 0,\n  'iframe::marginheight': 0,\n  'iframe::marginwidth': 0,\n  'iframe::width': 0,\n  'img::align': 0,\n  'img::alt': 0,\n  'img::border': 0,\n  'img::height': 0,\n  'img::hspace': 0,\n  'img::ismap': 0,\n  'img::name': 7,\n  'img::src': 1,\n  'img::usemap': 11,\n  'img::vspace': 0,\n  'img::width': 0,\n  'input::accept': 0,\n  'input::accesskey': 0,\n  'input::align': 0,\n  'input::alt': 0,\n  'input::autocomplete': 0,\n  'input::checked': 0,\n  'input::disabled': 0,\n  'input::inputmode': 0,\n  'input::ismap': 0,\n  'input::list': 5,\n  'input::max': 0,\n  'input::maxlength': 0,\n  'input::min': 0,\n  'input::multiple': 0,\n  'input::name': 8,\n  'input::onblur': 2,\n  'input::onchange': 2,\n  'input::onfocus': 2,\n  'input::onselect': 2,\n  'input::placeholder': 0,\n  'input::readonly': 0,\n  'input::required': 0,\n  'input::size': 0,\n  'input::src': 1,\n  'input::step': 0,\n  'input::tabindex': 0,\n  'input::type': 0,\n  'input::usemap': 11,\n  'input::value': 0,\n  'ins::cite': 1,\n  'ins::datetime': 0,\n  'label::accesskey': 0,\n  'label::for': 5,\n  'label::onblur': 2,\n  'label::onfocus': 2,\n  'legend::accesskey': 0,\n  'legend::align': 0,\n  'li::type': 0,\n  'li::value': 0,\n  'map::name': 7,\n  'menu::compact': 0,\n  'menu::label': 0,\n  'menu::type': 0,\n  'meter::high': 0,\n  'meter::low': 0,\n  'meter::max': 0,\n  'meter::min': 0,\n  'meter::value': 0,\n  'ol::compact': 0,\n  'ol::reversed': 0,\n  'ol::start': 0,\n  'ol::type': 0,\n  'optgroup::disabled': 0,\n  'optgroup::label': 0,\n  'option::disabled': 0,\n  'option::label': 0,\n  'option::selected': 0,\n  'option::value': 0,\n  'output::for': 6,\n  'output::name': 8,\n  'p::align': 0,\n  'pre::width': 0,\n  'progress::max': 0,\n  'progress::min': 0,\n  'progress::value': 0,\n  'q::cite': 1,\n  'select::autocomplete': 0,\n  'select::disabled': 0,\n  'select::multiple': 0,\n  'select::name': 8,\n  'select::onblur': 2,\n  'select::onchange': 2,\n  'select::onfocus': 2,\n  'select::required': 0,\n  'select::size': 0,\n  'select::tabindex': 0,\n  'source::type': 0,\n  'table::align': 0,\n  'table::bgcolor': 0,\n  'table::border': 0,\n  'table::cellpadding': 0,\n  'table::cellspacing': 0,\n  'table::frame': 0,\n  'table::rules': 0,\n  'table::summary': 0,\n  'table::width': 0,\n  'tbody::align': 0,\n  'tbody::char': 0,\n  'tbody::charoff': 0,\n  'tbody::valign': 0,\n  'td::abbr': 0,\n  'td::align': 0,\n  'td::axis': 0,\n  'td::bgcolor': 0,\n  'td::char': 0,\n  'td::charoff': 0,\n  'td::colspan': 0,\n  'td::headers': 6,\n  'td::height': 0,\n  'td::nowrap': 0,\n  'td::rowspan': 0,\n  'td::scope': 0,\n  'td::valign': 0,\n  'td::width': 0,\n  'textarea::accesskey': 0,\n  'textarea::autocomplete': 0,\n  'textarea::cols': 0,\n  'textarea::disabled': 0,\n  'textarea::inputmode': 0,\n  'textarea::name': 8,\n  'textarea::onblur': 2,\n  'textarea::onchange': 2,\n  'textarea::onfocus': 2,\n  'textarea::onselect': 2,\n  'textarea::placeholder': 0,\n  'textarea::readonly': 0,\n  'textarea::required': 0,\n  'textarea::rows': 0,\n  'textarea::tabindex': 0,\n  'textarea::wrap': 0,\n  'tfoot::align': 0,\n  'tfoot::char': 0,\n  'tfoot::charoff': 0,\n  'tfoot::valign': 0,\n  'th::abbr': 0,\n  'th::align': 0,\n  'th::axis': 0,\n  'th::bgcolor': 0,\n  'th::char': 0,\n  'th::charoff': 0,\n  'th::colspan': 0,\n  'th::headers': 6,\n  'th::height': 0,\n  'th::nowrap': 0,\n  'th::rowspan': 0,\n  'th::scope': 0,\n  'th::valign': 0,\n  'th::width': 0,\n  'thead::align': 0,\n  'thead::char': 0,\n  'thead::charoff': 0,\n  'thead::valign': 0,\n  'tr::align': 0,\n  'tr::bgcolor': 0,\n  'tr::char': 0,\n  'tr::charoff': 0,\n  'tr::valign': 0,\n  'track::default': 0,\n  'track::kind': 0,\n  'track::label': 0,\n  'track::srclang': 0,\n  'ul::compact': 0,\n  'ul::type': 0,\n  'video::controls': 0,\n  'video::height': 0,\n  'video::loop': 0,\n  'video::mediagroup': 5,\n  'video::muted': 0,\n  'video::poster': 1,\n  'video::preload': 0,\n  'video::width': 0\n};\nhtml4[ 'ATTRIBS' ] = html4.ATTRIBS;\nhtml4.eflags = {\n  'OPTIONAL_ENDTAG': 1,\n  'EMPTY': 2,\n  'CDATA': 4,\n  'RCDATA': 8,\n  'UNSAFE': 16,\n  'FOLDABLE': 32,\n  'SCRIPT': 64,\n  'STYLE': 128,\n  'VIRTUALIZED': 256\n};\nhtml4[ 'eflags' ] = html4.eflags;\n// these are bitmasks of the eflags above.\nhtml4.ELEMENTS = {\n  'a': 0,\n  'abbr': 0,\n  'acronym': 0,\n  'address': 0,\n  'applet': 272,\n  'area': 2,\n  'article': 0,\n  'aside': 0,\n  'audio': 0,\n  'b': 0,\n  'base': 274,\n  'basefont': 274,\n  'bdi': 0,\n  'bdo': 0,\n  'big': 0,\n  'blockquote': 0,\n  'body': 305,\n  'br': 2,\n  'button': 0,\n  'canvas': 0,\n  'caption': 0,\n  'center': 0,\n  'cite': 0,\n  'code': 0,\n  'col': 2,\n  'colgroup': 1,\n  'command': 2,\n  'data': 0,\n  'datalist': 0,\n  'dd': 1,\n  'del': 0,\n  'details': 0,\n  'dfn': 0,\n  'dialog': 272,\n  'dir': 0,\n  'div': 0,\n  'dl': 0,\n  'dt': 1,\n  'em': 0,\n  'fieldset': 0,\n  'figcaption': 0,\n  'figure': 0,\n  'font': 0,\n  'footer': 0,\n  'form': 0,\n  'frame': 274,\n  'frameset': 272,\n  'h1': 0,\n  'h2': 0,\n  'h3': 0,\n  'h4': 0,\n  'h5': 0,\n  'h6': 0,\n  'head': 305,\n  'header': 0,\n  'hgroup': 0,\n  'hr': 2,\n  'html': 305,\n  'i': 0,\n  'iframe': 16,\n  'img': 2,\n  'input': 2,\n  'ins': 0,\n  'isindex': 274,\n  'kbd': 0,\n  'keygen': 274,\n  'label': 0,\n  'legend': 0,\n  'li': 1,\n  'link': 274,\n  'map': 0,\n  'mark': 0,\n  'menu': 0,\n  'meta': 274,\n  'meter': 0,\n  'nav': 0,\n  'nobr': 0,\n  'noembed': 276,\n  'noframes': 276,\n  'noscript': 276,\n  'object': 272,\n  'ol': 0,\n  'optgroup': 0,\n  'option': 1,\n  'output': 0,\n  'p': 1,\n  'param': 274,\n  'pre': 0,\n  'progress': 0,\n  'q': 0,\n  's': 0,\n  'samp': 0,\n  'script': 84,\n  'section': 0,\n  'select': 0,\n  'small': 0,\n  'source': 2,\n  'span': 0,\n  'strike': 0,\n  'strong': 0,\n  'style': 148,\n  'sub': 0,\n  'summary': 0,\n  'sup': 0,\n  'table': 0,\n  'tbody': 1,\n  'td': 1,\n  'textarea': 8,\n  'tfoot': 1,\n  'th': 1,\n  'thead': 1,\n  'time': 0,\n  'title': 280,\n  'tr': 1,\n  'track': 2,\n  'tt': 0,\n  'u': 0,\n  'ul': 0,\n  'var': 0,\n  'video': 0,\n  'wbr': 2\n};\nhtml4[ 'ELEMENTS' ] = html4.ELEMENTS;\nhtml4.ELEMENT_DOM_INTERFACES = {\n  'a': 'HTMLAnchorElement',\n  'abbr': 'HTMLElement',\n  'acronym': 'HTMLElement',\n  'address': 'HTMLElement',\n  'applet': 'HTMLAppletElement',\n  'area': 'HTMLAreaElement',\n  'article': 'HTMLElement',\n  'aside': 'HTMLElement',\n  'audio': 'HTMLAudioElement',\n  'b': 'HTMLElement',\n  'base': 'HTMLBaseElement',\n  'basefont': 'HTMLBaseFontElement',\n  'bdi': 'HTMLElement',\n  'bdo': 'HTMLElement',\n  'big': 'HTMLElement',\n  'blockquote': 'HTMLQuoteElement',\n  'body': 'HTMLBodyElement',\n  'br': 'HTMLBRElement',\n  'button': 'HTMLButtonElement',\n  'canvas': 'HTMLCanvasElement',\n  'caption': 'HTMLTableCaptionElement',\n  'center': 'HTMLElement',\n  'cite': 'HTMLElement',\n  'code': 'HTMLElement',\n  'col': 'HTMLTableColElement',\n  'colgroup': 'HTMLTableColElement',\n  'command': 'HTMLCommandElement',\n  'data': 'HTMLElement',\n  'datalist': 'HTMLDataListElement',\n  'dd': 'HTMLElement',\n  'del': 'HTMLModElement',\n  'details': 'HTMLDetailsElement',\n  'dfn': 'HTMLElement',\n  'dialog': 'HTMLDialogElement',\n  'dir': 'HTMLDirectoryElement',\n  'div': 'HTMLDivElement',\n  'dl': 'HTMLDListElement',\n  'dt': 'HTMLElement',\n  'em': 'HTMLElement',\n  'fieldset': 'HTMLFieldSetElement',\n  'figcaption': 'HTMLElement',\n  'figure': 'HTMLElement',\n  'font': 'HTMLFontElement',\n  'footer': 'HTMLElement',\n  'form': 'HTMLFormElement',\n  'frame': 'HTMLFrameElement',\n  'frameset': 'HTMLFrameSetElement',\n  'h1': 'HTMLHeadingElement',\n  'h2': 'HTMLHeadingElement',\n  'h3': 'HTMLHeadingElement',\n  'h4': 'HTMLHeadingElement',\n  'h5': 'HTMLHeadingElement',\n  'h6': 'HTMLHeadingElement',\n  'head': 'HTMLHeadElement',\n  'header': 'HTMLElement',\n  'hgroup': 'HTMLElement',\n  'hr': 'HTMLHRElement',\n  'html': 'HTMLHtmlElement',\n  'i': 'HTMLElement',\n  'iframe': 'HTMLIFrameElement',\n  'img': 'HTMLImageElement',\n  'input': 'HTMLInputElement',\n  'ins': 'HTMLModElement',\n  'isindex': 'HTMLUnknownElement',\n  'kbd': 'HTMLElement',\n  'keygen': 'HTMLKeygenElement',\n  'label': 'HTMLLabelElement',\n  'legend': 'HTMLLegendElement',\n  'li': 'HTMLLIElement',\n  'link': 'HTMLLinkElement',\n  'map': 'HTMLMapElement',\n  'mark': 'HTMLElement',\n  'menu': 'HTMLMenuElement',\n  'meta': 'HTMLMetaElement',\n  'meter': 'HTMLMeterElement',\n  'nav': 'HTMLElement',\n  'nobr': 'HTMLElement',\n  'noembed': 'HTMLElement',\n  'noframes': 'HTMLElement',\n  'noscript': 'HTMLElement',\n  'object': 'HTMLObjectElement',\n  'ol': 'HTMLOListElement',\n  'optgroup': 'HTMLOptGroupElement',\n  'option': 'HTMLOptionElement',\n  'output': 'HTMLOutputElement',\n  'p': 'HTMLParagraphElement',\n  'param': 'HTMLParamElement',\n  'pre': 'HTMLPreElement',\n  'progress': 'HTMLProgressElement',\n  'q': 'HTMLQuoteElement',\n  's': 'HTMLElement',\n  'samp': 'HTMLElement',\n  'script': 'HTMLScriptElement',\n  'section': 'HTMLElement',\n  'select': 'HTMLSelectElement',\n  'small': 'HTMLElement',\n  'source': 'HTMLSourceElement',\n  'span': 'HTMLSpanElement',\n  'strike': 'HTMLElement',\n  'strong': 'HTMLElement',\n  'style': 'HTMLStyleElement',\n  'sub': 'HTMLElement',\n  'summary': 'HTMLElement',\n  'sup': 'HTMLElement',\n  'table': 'HTMLTableElement',\n  'tbody': 'HTMLTableSectionElement',\n  'td': 'HTMLTableDataCellElement',\n  'textarea': 'HTMLTextAreaElement',\n  'tfoot': 'HTMLTableSectionElement',\n  'th': 'HTMLTableHeaderCellElement',\n  'thead': 'HTMLTableSectionElement',\n  'time': 'HTMLTimeElement',\n  'title': 'HTMLTitleElement',\n  'tr': 'HTMLTableRowElement',\n  'track': 'HTMLTrackElement',\n  'tt': 'HTMLElement',\n  'u': 'HTMLElement',\n  'ul': 'HTMLUListElement',\n  'var': 'HTMLElement',\n  'video': 'HTMLVideoElement',\n  'wbr': 'HTMLElement'\n};\nhtml4[ 'ELEMENT_DOM_INTERFACES' ] = html4.ELEMENT_DOM_INTERFACES;\nhtml4.ueffects = {\n  'NOT_LOADED': 0,\n  'SAME_DOCUMENT': 1,\n  'NEW_DOCUMENT': 2\n};\nhtml4[ 'ueffects' ] = html4.ueffects;\nhtml4.URIEFFECTS = {\n  'a::href': 2,\n  'area::href': 2,\n  'blockquote::cite': 0,\n  'command::icon': 1,\n  'del::cite': 0,\n  'form::action': 2,\n  'img::src': 1,\n  'input::src': 1,\n  'ins::cite': 0,\n  'q::cite': 0,\n  'video::poster': 1\n};\nhtml4[ 'URIEFFECTS' ] = html4.URIEFFECTS;\nhtml4.ltypes = {\n  'UNSANDBOXED': 2,\n  'SANDBOXED': 1,\n  'DATA': 0\n};\nhtml4[ 'ltypes' ] = html4.ltypes;\nhtml4.LOADERTYPES = {\n  'a::href': 2,\n  'area::href': 2,\n  'blockquote::cite': 2,\n  'command::icon': 1,\n  'del::cite': 2,\n  'form::action': 2,\n  'img::src': 1,\n  'input::src': 1,\n  'ins::cite': 2,\n  'q::cite': 2,\n  'video::poster': 1\n};\nhtml4[ 'LOADERTYPES' ] = html4.LOADERTYPES;\n\n// Copyright (C) 2006 Google Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview\n * An HTML sanitizer that can satisfy a variety of security policies.\n *\n * <p>\n * The HTML sanitizer is built around a SAX parser and HTML element and\n * attributes schemas.\n *\n * If the cssparser is loaded, inline styles are sanitized using the\n * css property and value schemas.  Else they are remove during\n * sanitization.\n *\n * If it exists, uses parseCssDeclarations, sanitizeCssProperty,  cssSchema\n *\n * @author mikesamuel@gmail.com\n * @author jasvir@gmail.com\n * \\@requires html4, URI\n * \\@overrides window\n * \\@provides html, html_sanitize\n */\n\n// The Turkish i seems to be a non-issue, but abort in case it is.\nif ('I'.toLowerCase() !== 'i') { throw 'I/i problem'; }\n\n/**\n * \\@namespace\n */\nvar html = (function(html4) {\n\n  // For closure compiler\n  var parseCssDeclarations, sanitizeCssProperty, cssSchema;\n  if ('undefined' !== typeof window) {\n    parseCssDeclarations = window['parseCssDeclarations'];\n    sanitizeCssProperty = window['sanitizeCssProperty'];\n    cssSchema = window['cssSchema'];\n  }\n\n  // The keys of this object must be 'quoted' or JSCompiler will mangle them!\n  // This is a partial list -- lookupEntity() uses the host browser's parser\n  // (when available) to implement full entity lookup.\n  // Note that entities are in general case-sensitive; the uppercase ones are\n  // explicitly defined by HTML5 (presumably as compatibility).\n  var ENTITIES = {\n    'lt': '<',\n    'LT': '<',\n    'gt': '>',\n    'GT': '>',\n    'amp': '&',\n    'AMP': '&',\n    'quot': '\"',\n    'apos': '\\'',\n    'nbsp': '\\u00A0'\n  };\n\n  // Patterns for types of entity/character reference names.\n  var decimalEscapeRe = /^#(\\d+)$/;\n  var hexEscapeRe = /^#x([0-9A-Fa-f]+)$/;\n  // contains every entity per http://www.w3.org/TR/2011/WD-html5-20110113/named-character-references.html\n  var safeEntityNameRe = /^[A-Za-z][A-za-z0-9]+$/;\n  // Used as a hook to invoke the browser's entity parsing. <textarea> is used\n  // because its content is parsed for entities but not tags.\n  // TODO(kpreid): This retrieval is a kludge and leads to silent loss of\n  // functionality if the document isn't available.\n  var entityLookupElement =\n      ('undefined' !== typeof window && window['document'])\n          ? window['document'].createElement('textarea') : null;\n  /**\n   * Decodes an HTML entity.\n   *\n   * {\\@updoc\n   * $ lookupEntity('lt')\n   * # '<'\n   * $ lookupEntity('GT')\n   * # '>'\n   * $ lookupEntity('amp')\n   * # '&'\n   * $ lookupEntity('nbsp')\n   * # '\\xA0'\n   * $ lookupEntity('apos')\n   * # \"'\"\n   * $ lookupEntity('quot')\n   * # '\"'\n   * $ lookupEntity('#xa')\n   * # '\\n'\n   * $ lookupEntity('#10')\n   * # '\\n'\n   * $ lookupEntity('#x0a')\n   * # '\\n'\n   * $ lookupEntity('#010')\n   * # '\\n'\n   * $ lookupEntity('#x00A')\n   * # '\\n'\n   * $ lookupEntity('Pi')      // Known failure\n   * # '\\u03A0'\n   * $ lookupEntity('pi')      // Known failure\n   * # '\\u03C0'\n   * }\n   *\n   * @param {string} name the content between the '&' and the ';'.\n   * @return {string} a single unicode code-point as a string.\n   */\n  function lookupEntity(name) {\n    // TODO: entity lookup as specified by HTML5 actually depends on the\n    // presence of the \";\".\n    if (ENTITIES.hasOwnProperty(name)) { return ENTITIES[name]; }\n    var m = name.match(decimalEscapeRe);\n    if (m) {\n      return String.fromCharCode(parseInt(m[1], 10));\n    } else if (!!(m = name.match(hexEscapeRe))) {\n      return String.fromCharCode(parseInt(m[1], 16));\n    } else if (entityLookupElement && safeEntityNameRe.test(name)) {\n      entityLookupElement.innerHTML = '&' + name + ';';\n      var text = entityLookupElement.textContent;\n      ENTITIES[name] = text;\n      return text;\n    } else {\n      return '&' + name + ';';\n    }\n  }\n\n  function decodeOneEntity(_, name) {\n    return lookupEntity(name);\n  }\n\n  var nulRe = /\\0/g;\n  function stripNULs(s) {\n    return s.replace(nulRe, '');\n  }\n\n  var ENTITY_RE_1 = /&(#[0-9]+|#[xX][0-9A-Fa-f]+|\\w+);/g;\n  var ENTITY_RE_2 = /^(#[0-9]+|#[xX][0-9A-Fa-f]+|\\w+);/;\n  /**\n   * The plain text of a chunk of HTML CDATA which possibly containing.\n   *\n   * {\\@updoc\n   * $ unescapeEntities('')\n   * # ''\n   * $ unescapeEntities('hello World!')\n   * # 'hello World!'\n   * $ unescapeEntities('1 &lt; 2 &amp;&AMP; 4 &gt; 3&#10;')\n   * # '1 < 2 && 4 > 3\\n'\n   * $ unescapeEntities('&lt;&lt <- unfinished entity&gt;')\n   * # '<&lt <- unfinished entity>'\n   * $ unescapeEntities('/foo?bar=baz&copy=true')  // & often unescaped in URLS\n   * # '/foo?bar=baz&copy=true'\n   * $ unescapeEntities('pi=&pi;&#x3c0;, Pi=&Pi;\\u03A0') // FIXME: known failure\n   * # 'pi=\\u03C0\\u03c0, Pi=\\u03A0\\u03A0'\n   * }\n   *\n   * @param {string} s a chunk of HTML CDATA.  It must not start or end inside\n   *     an HTML entity.\n   */\n  function unescapeEntities(s) {\n    return s.replace(ENTITY_RE_1, decodeOneEntity);\n  }\n\n  var ampRe = /&/g;\n  var looseAmpRe = /&([^a-z#]|#(?:[^0-9x]|x(?:[^0-9a-f]|$)|$)|$)/gi;\n  var ltRe = /[<]/g;\n  var gtRe = />/g;\n  var quotRe = /\\\"/g;\n\n  /**\n   * Escapes HTML special characters in attribute values.\n   *\n   * {\\@updoc\n   * $ escapeAttrib('')\n   * # ''\n   * $ escapeAttrib('\"<<&==&>>\"')  // Do not just escape the first occurrence.\n   * # '&#34;&lt;&lt;&amp;&#61;&#61;&amp;&gt;&gt;&#34;'\n   * $ escapeAttrib('Hello <World>!')\n   * # 'Hello &lt;World&gt;!'\n   * }\n   */\n  function escapeAttrib(s) {\n    return ('' + s).replace(ampRe, '&amp;').replace(ltRe, '&lt;')\n        .replace(gtRe, '&gt;').replace(quotRe, '&#34;');\n  }\n\n  /**\n   * Escape entities in RCDATA that can be escaped without changing the meaning.\n   * {\\@updoc\n   * $ normalizeRCData('1 < 2 &&amp; 3 > 4 &amp;& 5 &lt; 7&8')\n   * # '1 &lt; 2 &amp;&amp; 3 &gt; 4 &amp;&amp; 5 &lt; 7&amp;8'\n   * }\n   */\n  function normalizeRCData(rcdata) {\n    return rcdata\n        .replace(looseAmpRe, '&amp;$1')\n        .replace(ltRe, '&lt;')\n        .replace(gtRe, '&gt;');\n  }\n\n  // TODO(felix8a): validate sanitizer regexs against the HTML5 grammar at\n  // http://www.whatwg.org/specs/web-apps/current-work/multipage/syntax.html\n  // http://www.whatwg.org/specs/web-apps/current-work/multipage/parsing.html\n  // http://www.whatwg.org/specs/web-apps/current-work/multipage/tokenization.html\n  // http://www.whatwg.org/specs/web-apps/current-work/multipage/tree-construction.html\n\n  // We initially split input so that potentially meaningful characters\n  // like '<' and '>' are separate tokens, using a fast dumb process that\n  // ignores quoting.  Then we walk that token stream, and when we see a\n  // '<' that's the start of a tag, we use ATTR_RE to extract tag\n  // attributes from the next token.  That token will never have a '>'\n  // character.  However, it might have an unbalanced quote character, and\n  // when we see that, we combine additional tokens to balance the quote.\n\n  var ATTR_RE = new RegExp(\n    '^\\\\s*' +\n    '([-.:\\\\w]+)' +             // 1 = Attribute name\n    '(?:' + (\n      '\\\\s*(=)\\\\s*' +           // 2 = Is there a value?\n      '(' + (                   // 3 = Attribute value\n        // TODO(felix8a): maybe use backref to match quotes\n        '(\\\")[^\\\"]*(\\\"|$)' +    // 4, 5 = Double-quoted string\n        '|' +\n        '(\\')[^\\']*(\\'|$)' +    // 6, 7 = Single-quoted string\n        '|' +\n        // Positive lookahead to prevent interpretation of\n        // <foo a= b=c> as <foo a='b=c'>\n        // TODO(felix8a): might be able to drop this case\n        '(?=[a-z][-\\\\w]*\\\\s*=)' +\n        '|' +\n        // Unquoted value that isn't an attribute name\n        // (since we didn't match the positive lookahead above)\n        '[^\\\"\\'\\\\s]*' ) +\n      ')' ) +\n    ')?',\n    'i');\n\n  // false on IE<=8, true on most other browsers\n  var splitWillCapture = ('a,b'.split(/(,)/).length === 3);\n\n  // bitmask for tags with special parsing, like <script> and <textarea>\n  var EFLAGS_TEXT = html4.eflags['CDATA'] | html4.eflags['RCDATA'];\n\n  /**\n   * Given a SAX-like event handler, produce a function that feeds those\n   * events and a parameter to the event handler.\n   *\n   * The event handler has the form:{@code\n   * {\n   *   // Name is an upper-case HTML tag name.  Attribs is an array of\n   *   // alternating upper-case attribute names, and attribute values.  The\n   *   // attribs array is reused by the parser.  Param is the value passed to\n   *   // the saxParser.\n   *   startTag: function (name, attribs, param) { ... },\n   *   endTag:   function (name, param) { ... },\n   *   pcdata:   function (text, param) { ... },\n   *   rcdata:   function (text, param) { ... },\n   *   cdata:    function (text, param) { ... },\n   *   startDoc: function (param) { ... },\n   *   endDoc:   function (param) { ... }\n   * }}\n   *\n   * @param {Object} handler a record containing event handlers.\n   * @return {function(string, Object)} A function that takes a chunk of HTML\n   *     and a parameter.  The parameter is passed on to the handler methods.\n   */\n  function makeSaxParser(handler) {\n    // Accept quoted or unquoted keys (Closure compat)\n    var hcopy = {\n      cdata: handler.cdata || handler['cdata'],\n      comment: handler.comment || handler['comment'],\n      endDoc: handler.endDoc || handler['endDoc'],\n      endTag: handler.endTag || handler['endTag'],\n      pcdata: handler.pcdata || handler['pcdata'],\n      rcdata: handler.rcdata || handler['rcdata'],\n      startDoc: handler.startDoc || handler['startDoc'],\n      startTag: handler.startTag || handler['startTag']\n    };\n    return function(htmlText, param) {\n      return parse(htmlText, hcopy, param);\n    };\n  }\n\n  // Parsing strategy is to split input into parts that might be lexically\n  // meaningful (every \">\" becomes a separate part), and then recombine\n  // parts if we discover they're in a different context.\n\n  // TODO(felix8a): Significant performance regressions from -legacy,\n  // tested on\n  //    Chrome 18.0\n  //    Firefox 11.0\n  //    IE 6, 7, 8, 9\n  //    Opera 11.61\n  //    Safari 5.1.3\n  // Many of these are unusual patterns that are linearly slower and still\n  // pretty fast (eg 1ms to 5ms), so not necessarily worth fixing.\n\n  // TODO(felix8a): \"<script> && && && ... <\\/script>\" is slower on all\n  // browsers.  The hotspot is htmlSplit.\n\n  // TODO(felix8a): \"<p title='>>>>...'><\\/p>\" is slower on all browsers.\n  // This is partly htmlSplit, but the hotspot is parseTagAndAttrs.\n\n  // TODO(felix8a): \"<a><\\/a><a><\\/a>...\" is slower on IE9.\n  // \"<a>1<\\/a><a>1<\\/a>...\" is faster, \"<a><\\/a>2<a><\\/a>2...\" is faster.\n\n  // TODO(felix8a): \"<p<p<p...\" is slower on IE[6-8]\n\n  var continuationMarker = {};\n  function parse(htmlText, handler, param) {\n    var m, p, tagName;\n    var parts = htmlSplit(htmlText);\n    var state = {\n      noMoreGT: false,\n      noMoreEndComments: false\n    };\n    parseCPS(handler, parts, 0, state, param);\n  }\n\n  function continuationMaker(h, parts, initial, state, param) {\n    return function () {\n      parseCPS(h, parts, initial, state, param);\n    };\n  }\n\n  function parseCPS(h, parts, initial, state, param) {\n    try {\n      if (h.startDoc && initial == 0) { h.startDoc(param); }\n      var m, p, tagName;\n      for (var pos = initial, end = parts.length; pos < end;) {\n        var current = parts[pos++];\n        var next = parts[pos];\n        switch (current) {\n        case '&':\n          if (ENTITY_RE_2.test(next)) {\n            if (h.pcdata) {\n              h.pcdata('&' + next, param, continuationMarker,\n                continuationMaker(h, parts, pos, state, param));\n            }\n            pos++;\n          } else {\n            if (h.pcdata) { h.pcdata(\"&amp;\", param, continuationMarker,\n                continuationMaker(h, parts, pos, state, param));\n            }\n          }\n          break;\n        case '<\\/':\n          if (m = /^([-\\w:]+)[^\\'\\\"]*/.exec(next)) {\n            if (m[0].length === next.length && parts[pos + 1] === '>') {\n              // fast case, no attribute parsing needed\n              pos += 2;\n              tagName = m[1].toLowerCase();\n              if (h.endTag) {\n                h.endTag(tagName, param, continuationMarker,\n                  continuationMaker(h, parts, pos, state, param));\n              }\n            } else {\n              // slow case, need to parse attributes\n              // TODO(felix8a): do we really care about misparsing this?\n              pos = parseEndTag(\n                parts, pos, h, param, continuationMarker, state);\n            }\n          } else {\n            if (h.pcdata) {\n              h.pcdata('&lt;/', param, continuationMarker,\n                continuationMaker(h, parts, pos, state, param));\n            }\n          }\n          break;\n        case '<':\n          if (m = /^([-\\w:]+)\\s*\\/?/.exec(next)) {\n            if (m[0].length === next.length && parts[pos + 1] === '>') {\n              // fast case, no attribute parsing needed\n              pos += 2;\n              tagName = m[1].toLowerCase();\n              if (h.startTag) {\n                h.startTag(tagName, [], param, continuationMarker,\n                  continuationMaker(h, parts, pos, state, param));\n              }\n              // tags like <script> and <textarea> have special parsing\n              var eflags = html4.ELEMENTS[tagName];\n              if (eflags & EFLAGS_TEXT) {\n                var tag = { name: tagName, next: pos, eflags: eflags };\n                pos = parseText(\n                  parts, tag, h, param, continuationMarker, state);\n              }\n            } else {\n              // slow case, need to parse attributes\n              pos = parseStartTag(\n                parts, pos, h, param, continuationMarker, state);\n            }\n          } else {\n            if (h.pcdata) {\n              h.pcdata('&lt;', param, continuationMarker,\n                continuationMaker(h, parts, pos, state, param));\n            }\n          }\n          break;\n        case '<\\!--':\n          // The pathological case is n copies of '<\\!--' without '-->', and\n          // repeated failure to find '-->' is quadratic.  We avoid that by\n          // remembering when search for '-->' fails.\n          if (!state.noMoreEndComments) {\n            // A comment <\\!--x--> is split into three tokens:\n            //   '<\\!--', 'x--', '>'\n            // We want to find the next '>' token that has a preceding '--'.\n            // pos is at the 'x--'.\n            for (p = pos + 1; p < end; p++) {\n              if (parts[p] === '>' && /--$/.test(parts[p - 1])) { break; }\n            }\n            if (p < end) {\n              if (h.comment) {\n                var comment = parts.slice(pos, p).join('');\n                h.comment(\n                  comment.substr(0, comment.length - 2), param,\n                  continuationMarker,\n                  continuationMaker(h, parts, p + 1, state, param));\n              }\n              pos = p + 1;\n            } else {\n              state.noMoreEndComments = true;\n            }\n          }\n          if (state.noMoreEndComments) {\n            if (h.pcdata) {\n              h.pcdata('&lt;!--', param, continuationMarker,\n                continuationMaker(h, parts, pos, state, param));\n            }\n          }\n          break;\n        case '<\\!':\n          if (!/^\\w/.test(next)) {\n            if (h.pcdata) {\n              h.pcdata('&lt;!', param, continuationMarker,\n                continuationMaker(h, parts, pos, state, param));\n            }\n          } else {\n            // similar to noMoreEndComment logic\n            if (!state.noMoreGT) {\n              for (p = pos + 1; p < end; p++) {\n                if (parts[p] === '>') { break; }\n              }\n              if (p < end) {\n                pos = p + 1;\n              } else {\n                state.noMoreGT = true;\n              }\n            }\n            if (state.noMoreGT) {\n              if (h.pcdata) {\n                h.pcdata('&lt;!', param, continuationMarker,\n                  continuationMaker(h, parts, pos, state, param));\n              }\n            }\n          }\n          break;\n        case '<?':\n          // similar to noMoreEndComment logic\n          if (!state.noMoreGT) {\n            for (p = pos + 1; p < end; p++) {\n              if (parts[p] === '>') { break; }\n            }\n            if (p < end) {\n              pos = p + 1;\n            } else {\n              state.noMoreGT = true;\n            }\n          }\n          if (state.noMoreGT) {\n            if (h.pcdata) {\n              h.pcdata('&lt;?', param, continuationMarker,\n                continuationMaker(h, parts, pos, state, param));\n            }\n          }\n          break;\n        case '>':\n          if (h.pcdata) {\n            h.pcdata(\"&gt;\", param, continuationMarker,\n              continuationMaker(h, parts, pos, state, param));\n          }\n          break;\n        case '':\n          break;\n        default:\n          if (h.pcdata) {\n            h.pcdata(current, param, continuationMarker,\n              continuationMaker(h, parts, pos, state, param));\n          }\n          break;\n        }\n      }\n      if (h.endDoc) { h.endDoc(param); }\n    } catch (e) {\n      if (e !== continuationMarker) { throw e; }\n    }\n  }\n\n  // Split str into parts for the html parser.\n  function htmlSplit(str) {\n    // can't hoist this out of the function because of the re.exec loop.\n    var re = /(<\\/|<\\!--|<[!?]|[&<>])/g;\n    str += '';\n    if (splitWillCapture) {\n      return str.split(re);\n    } else {\n      var parts = [];\n      var lastPos = 0;\n      var m;\n      while ((m = re.exec(str)) !== null) {\n        parts.push(str.substring(lastPos, m.index));\n        parts.push(m[0]);\n        lastPos = m.index + m[0].length;\n      }\n      parts.push(str.substring(lastPos));\n      return parts;\n    }\n  }\n\n  function parseEndTag(parts, pos, h, param, continuationMarker, state) {\n    var tag = parseTagAndAttrs(parts, pos);\n    // drop unclosed tags\n    if (!tag) { return parts.length; }\n    if (h.endTag) {\n      h.endTag(tag.name, param, continuationMarker,\n        continuationMaker(h, parts, pos, state, param));\n    }\n    return tag.next;\n  }\n\n  function parseStartTag(parts, pos, h, param, continuationMarker, state) {\n    var tag = parseTagAndAttrs(parts, pos);\n    // drop unclosed tags\n    if (!tag) { return parts.length; }\n    if (h.startTag) {\n      h.startTag(tag.name, tag.attrs, param, continuationMarker,\n        continuationMaker(h, parts, tag.next, state, param));\n    }\n    // tags like <script> and <textarea> have special parsing\n    if (tag.eflags & EFLAGS_TEXT) {\n      return parseText(parts, tag, h, param, continuationMarker, state);\n    } else {\n      return tag.next;\n    }\n  }\n\n  var endTagRe = {};\n\n  // Tags like <script> and <textarea> are flagged as CDATA or RCDATA,\n  // which means everything is text until we see the correct closing tag.\n  function parseText(parts, tag, h, param, continuationMarker, state) {\n    var end = parts.length;\n    if (!endTagRe.hasOwnProperty(tag.name)) {\n      endTagRe[tag.name] = new RegExp('^' + tag.name + '(?:[\\\\s\\\\/]|$)', 'i');\n    }\n    var re = endTagRe[tag.name];\n    var first = tag.next;\n    var p = tag.next + 1;\n    for (; p < end; p++) {\n      if (parts[p - 1] === '<\\/' && re.test(parts[p])) { break; }\n    }\n    if (p < end) { p -= 1; }\n    var buf = parts.slice(first, p).join('');\n    if (tag.eflags & html4.eflags['CDATA']) {\n      if (h.cdata) {\n        h.cdata(buf, param, continuationMarker,\n          continuationMaker(h, parts, p, state, param));\n      }\n    } else if (tag.eflags & html4.eflags['RCDATA']) {\n      if (h.rcdata) {\n        h.rcdata(normalizeRCData(buf), param, continuationMarker,\n          continuationMaker(h, parts, p, state, param));\n      }\n    } else {\n      throw new Error('bug');\n    }\n    return p;\n  }\n\n  // at this point, parts[pos-1] is either \"<\" or \"<\\/\".\n  function parseTagAndAttrs(parts, pos) {\n    var m = /^([-\\w:]+)/.exec(parts[pos]);\n    var tag = {};\n    tag.name = m[1].toLowerCase();\n    tag.eflags = html4.ELEMENTS[tag.name];\n    var buf = parts[pos].substr(m[0].length);\n    // Find the next '>'.  We optimistically assume this '>' is not in a\n    // quoted context, and further down we fix things up if it turns out to\n    // be quoted.\n    var p = pos + 1;\n    var end = parts.length;\n    for (; p < end; p++) {\n      if (parts[p] === '>') { break; }\n      buf += parts[p];\n    }\n    if (end <= p) { return void 0; }\n    var attrs = [];\n    while (buf !== '') {\n      m = ATTR_RE.exec(buf);\n      if (!m) {\n        // No attribute found: skip garbage\n        buf = buf.replace(/^[\\s\\S][^a-z\\s]*/, '');\n\n      } else if ((m[4] && !m[5]) || (m[6] && !m[7])) {\n        // Unterminated quote: slurp to the next unquoted '>'\n        var quote = m[4] || m[6];\n        var sawQuote = false;\n        var abuf = [buf, parts[p++]];\n        for (; p < end; p++) {\n          if (sawQuote) {\n            if (parts[p] === '>') { break; }\n          } else if (0 <= parts[p].indexOf(quote)) {\n            sawQuote = true;\n          }\n          abuf.push(parts[p]);\n        }\n        // Slurp failed: lose the garbage\n        if (end <= p) { break; }\n        // Otherwise retry attribute parsing\n        buf = abuf.join('');\n        continue;\n\n      } else {\n        // We have an attribute\n        var aName = m[1].toLowerCase();\n        var aValue = m[2] ? decodeValue(m[3]) : '';\n        attrs.push(aName, aValue);\n        buf = buf.substr(m[0].length);\n      }\n    }\n    tag.attrs = attrs;\n    tag.next = p + 1;\n    return tag;\n  }\n\n  function decodeValue(v) {\n    var q = v.charCodeAt(0);\n    if (q === 0x22 || q === 0x27) { // \" or '\n      v = v.substr(1, v.length - 2);\n    }\n    return unescapeEntities(stripNULs(v));\n  }\n\n  /**\n   * Returns a function that strips unsafe tags and attributes from html.\n   * @param {function(string, Array.<string>): ?Array.<string>} tagPolicy\n   *     A function that takes (tagName, attribs[]), where tagName is a key in\n   *     html4.ELEMENTS and attribs is an array of alternating attribute names\n   *     and values.  It should return a record (as follows), or null to delete\n   *     the element.  It's okay for tagPolicy to modify the attribs array,\n   *     but the same array is reused, so it should not be held between calls.\n   *     Record keys:\n   *        attribs: (required) Sanitized attributes array.\n   *        tagName: Replacement tag name.\n   * @return {function(string, Array)} A function that sanitizes a string of\n   *     HTML and appends result strings to the second argument, an array.\n   */\n  function makeHtmlSanitizer(tagPolicy) {\n    var stack;\n    var ignoring;\n    var emit = function (text, out) {\n      if (!ignoring) { out.push(text); }\n    };\n    return makeSaxParser({\n      'startDoc': function(_) {\n        stack = [];\n        ignoring = false;\n      },\n      'startTag': function(tagNameOrig, attribs, out) {\n        if (ignoring) { return; }\n        if (!html4.ELEMENTS.hasOwnProperty(tagNameOrig)) { return; }\n        var eflagsOrig = html4.ELEMENTS[tagNameOrig];\n        if (eflagsOrig & html4.eflags['FOLDABLE']) {\n          return;\n        }\n\n        var decision = tagPolicy(tagNameOrig, attribs);\n        if (!decision) {\n          ignoring = !(eflagsOrig & html4.eflags['EMPTY']);\n          return;\n        } else if (typeof decision !== 'object') {\n          throw new Error('tagPolicy did not return object (old API?)');\n        }\n        if ('attribs' in decision) {\n          attribs = decision['attribs'];\n        } else {\n          throw new Error('tagPolicy gave no attribs');\n        }\n        var eflagsRep;\n        var tagNameRep;\n        if ('tagName' in decision) {\n          tagNameRep = decision['tagName'];\n          eflagsRep = html4.ELEMENTS[tagNameRep];\n        } else {\n          tagNameRep = tagNameOrig;\n          eflagsRep = eflagsOrig;\n        }\n        // TODO(mikesamuel): relying on tagPolicy not to insert unsafe\n        // attribute names.\n\n        // If this is an optional-end-tag element and either this element or its\n        // previous like sibling was rewritten, then insert a close tag to\n        // preserve structure.\n        if (eflagsOrig & html4.eflags['OPTIONAL_ENDTAG']) {\n          var onStack = stack[stack.length - 1];\n          if (onStack && onStack.orig === tagNameOrig &&\n              (onStack.rep !== tagNameRep || tagNameOrig !== tagNameRep)) {\n                out.push('<\\/', onStack.rep, '>');\n          }\n        }\n\n        if (!(eflagsOrig & html4.eflags['EMPTY'])) {\n          stack.push({orig: tagNameOrig, rep: tagNameRep});\n        }\n\n        out.push('<', tagNameRep);\n        for (var i = 0, n = attribs.length; i < n; i += 2) {\n          var attribName = attribs[i],\n              value = attribs[i + 1];\n          if (value !== null && value !== void 0) {\n            out.push(' ', attribName, '=\"', escapeAttrib(value), '\"');\n          }\n        }\n        out.push('>');\n\n        if ((eflagsOrig & html4.eflags['EMPTY'])\n            && !(eflagsRep & html4.eflags['EMPTY'])) {\n          // replacement is non-empty, synthesize end tag\n          out.push('<\\/', tagNameRep, '>');\n        }\n      },\n      'endTag': function(tagName, out) {\n        if (ignoring) {\n          ignoring = false;\n          return;\n        }\n        if (!html4.ELEMENTS.hasOwnProperty(tagName)) { return; }\n        var eflags = html4.ELEMENTS[tagName];\n        if (!(eflags & (html4.eflags['EMPTY'] | html4.eflags['FOLDABLE']))) {\n          var index;\n          if (eflags & html4.eflags['OPTIONAL_ENDTAG']) {\n            for (index = stack.length; --index >= 0;) {\n              var stackElOrigTag = stack[index].orig;\n              if (stackElOrigTag === tagName) { break; }\n              if (!(html4.ELEMENTS[stackElOrigTag] &\n                    html4.eflags['OPTIONAL_ENDTAG'])) {\n                // Don't pop non optional end tags looking for a match.\n                return;\n              }\n            }\n          } else {\n            for (index = stack.length; --index >= 0;) {\n              if (stack[index].orig === tagName) { break; }\n            }\n          }\n          if (index < 0) { return; }  // Not opened.\n          for (var i = stack.length; --i > index;) {\n            var stackElRepTag = stack[i].rep;\n            if (!(html4.ELEMENTS[stackElRepTag] &\n                  html4.eflags['OPTIONAL_ENDTAG'])) {\n              out.push('<\\/', stackElRepTag, '>');\n            }\n          }\n          if (index < stack.length) {\n            tagName = stack[index].rep;\n          }\n          stack.length = index;\n          out.push('<\\/', tagName, '>');\n        }\n      },\n      'pcdata': emit,\n      'rcdata': emit,\n      'cdata': emit,\n      'endDoc': function(out) {\n        for (; stack.length; stack.length--) {\n          out.push('<\\/', stack[stack.length - 1].rep, '>');\n        }\n      }\n    });\n  }\n\n  var ALLOWED_URI_SCHEMES = /^(?:https?|mailto|data)$/i;\n\n  function safeUri(uri, effect, ltype, hints, naiveUriRewriter) {\n    if (!naiveUriRewriter) { return null; }\n    try {\n      var parsed = URI.parse('' + uri);\n      if (parsed) {\n        if (!parsed.hasScheme() ||\n            ALLOWED_URI_SCHEMES.test(parsed.getScheme())) {\n          var safe = naiveUriRewriter(parsed, effect, ltype, hints);\n          return safe ? safe.toString() : null;\n        }\n      }\n    } catch (e) {\n      return null;\n    }\n    return null;\n  }\n\n  function log(logger, tagName, attribName, oldValue, newValue) {\n    if (!attribName) {\n      logger(tagName + \" removed\", {\n        change: \"removed\",\n        tagName: tagName\n      });\n    }\n    if (oldValue !== newValue) {\n      var changed = \"changed\";\n      if (oldValue && !newValue) {\n        changed = \"removed\";\n      } else if (!oldValue && newValue)  {\n        changed = \"added\";\n      }\n      logger(tagName + \".\" + attribName + \" \" + changed, {\n        change: changed,\n        tagName: tagName,\n        attribName: attribName,\n        oldValue: oldValue,\n        newValue: newValue\n      });\n    }\n  }\n\n  function lookupAttribute(map, tagName, attribName) {\n    var attribKey;\n    attribKey = tagName + '::' + attribName;\n    if (map.hasOwnProperty(attribKey)) {\n      return map[attribKey];\n    }\n    attribKey = '*::' + attribName;\n    if (map.hasOwnProperty(attribKey)) {\n      return map[attribKey];\n    }\n    return void 0;\n  }\n  function getAttributeType(tagName, attribName) {\n    return lookupAttribute(html4.ATTRIBS, tagName, attribName);\n  }\n  function getLoaderType(tagName, attribName) {\n    return lookupAttribute(html4.LOADERTYPES, tagName, attribName);\n  }\n  function getUriEffect(tagName, attribName) {\n    return lookupAttribute(html4.URIEFFECTS, tagName, attribName);\n  }\n\n  /**\n   * Sanitizes attributes on an HTML tag.\n   * @param {string} tagName An HTML tag name in lowercase.\n   * @param {Array.<?string>} attribs An array of alternating names and values.\n   * @param {?function(?string): ?string} opt_naiveUriRewriter A transform to\n   *     apply to URI attributes; it can return a new string value, or null to\n   *     delete the attribute.  If unspecified, URI attributes are deleted.\n   * @param {function(?string): ?string} opt_nmTokenPolicy A transform to apply\n   *     to attributes containing HTML names, element IDs, and space-separated\n   *     lists of classes; it can return a new string value, or null to delete\n   *     the attribute.  If unspecified, these attributes are kept unchanged.\n   * @return {Array.<?string>} The sanitized attributes as a list of alternating\n   *     names and values, where a null value means to omit the attribute.\n   */\n  function sanitizeAttribs(tagName, attribs,\n    opt_naiveUriRewriter, opt_nmTokenPolicy, opt_logger) {\n    // TODO(felix8a): it's obnoxious that domado duplicates much of this\n    // TODO(felix8a): maybe consistently enforce constraints like target=\n    for (var i = 0; i < attribs.length; i += 2) {\n      var attribName = attribs[i];\n      var value = attribs[i + 1];\n      var oldValue = value;\n      var atype = null, attribKey;\n      if ((attribKey = tagName + '::' + attribName,\n           html4.ATTRIBS.hasOwnProperty(attribKey)) ||\n          (attribKey = '*::' + attribName,\n           html4.ATTRIBS.hasOwnProperty(attribKey))) {\n        atype = html4.ATTRIBS[attribKey];\n      }\n      if (atype !== null) {\n        switch (atype) {\n          case html4.atype['NONE']: break;\n          case html4.atype['SCRIPT']:\n            value = null;\n            if (opt_logger) {\n              log(opt_logger, tagName, attribName, oldValue, value);\n            }\n            break;\n          case html4.atype['STYLE']:\n            if ('undefined' === typeof parseCssDeclarations) {\n              value = null;\n              if (opt_logger) {\n                log(opt_logger, tagName, attribName, oldValue, value);\n\t      }\n              break;\n            }\n            var sanitizedDeclarations = [];\n            parseCssDeclarations(\n                value,\n                {\n                  declaration: function (property, tokens) {\n                    var normProp = property.toLowerCase();\n                    var schema = cssSchema[normProp];\n                    if (!schema) {\n                      return;\n                    }\n                    sanitizeCssProperty(\n                        normProp, schema, tokens,\n                        opt_naiveUriRewriter\n                        ? function (url) {\n                            return safeUri(\n                                url, html4.ueffects.SAME_DOCUMENT,\n                                html4.ltypes.SANDBOXED,\n                                {\n                                  \"TYPE\": \"CSS\",\n                                  \"CSS_PROP\": normProp\n                                }, opt_naiveUriRewriter);\n                          }\n                        : null);\n                    sanitizedDeclarations.push(property + ': ' + tokens.join(' '));\n                  }\n                });\n            value = sanitizedDeclarations.length > 0 ?\n              sanitizedDeclarations.join(' ; ') : null;\n            if (opt_logger) {\n              log(opt_logger, tagName, attribName, oldValue, value);\n            }\n            break;\n          case html4.atype['ID']:\n          case html4.atype['IDREF']:\n          case html4.atype['IDREFS']:\n          case html4.atype['GLOBAL_NAME']:\n          case html4.atype['LOCAL_NAME']:\n          case html4.atype['CLASSES']:\n            value = opt_nmTokenPolicy ? opt_nmTokenPolicy(value) : value;\n            if (opt_logger) {\n              log(opt_logger, tagName, attribName, oldValue, value);\n            }\n            break;\n          case html4.atype['URI']:\n            value = safeUri(value,\n              getUriEffect(tagName, attribName),\n              getLoaderType(tagName, attribName),\n              {\n                \"TYPE\": \"MARKUP\",\n                \"XML_ATTR\": attribName,\n                \"XML_TAG\": tagName\n              }, opt_naiveUriRewriter);\n              if (opt_logger) {\n              log(opt_logger, tagName, attribName, oldValue, value);\n            }\n            break;\n          case html4.atype['URI_FRAGMENT']:\n            if (value && '#' === value.charAt(0)) {\n              value = value.substring(1);  // remove the leading '#'\n              value = opt_nmTokenPolicy ? opt_nmTokenPolicy(value) : value;\n              if (value !== null && value !== void 0) {\n                value = '#' + value;  // restore the leading '#'\n              }\n            } else {\n              value = null;\n            }\n            if (opt_logger) {\n              log(opt_logger, tagName, attribName, oldValue, value);\n            }\n            break;\n          default:\n            value = null;\n            if (opt_logger) {\n              log(opt_logger, tagName, attribName, oldValue, value);\n            }\n            break;\n        }\n      } else {\n        value = null;\n        if (opt_logger) {\n          log(opt_logger, tagName, attribName, oldValue, value);\n        }\n      }\n      attribs[i + 1] = value;\n    }\n    return attribs;\n  }\n\n  /**\n   * Creates a tag policy that omits all tags marked UNSAFE in html4-defs.js\n   * and applies the default attribute sanitizer with the supplied policy for\n   * URI attributes and NMTOKEN attributes.\n   * @param {?function(?string): ?string} opt_naiveUriRewriter A transform to\n   *     apply to URI attributes.  If not given, URI attributes are deleted.\n   * @param {function(?string): ?string} opt_nmTokenPolicy A transform to apply\n   *     to attributes containing HTML names, element IDs, and space-separated\n   *     lists of classes.  If not given, such attributes are left unchanged.\n   * @return {function(string, Array.<?string>)} A tagPolicy suitable for\n   *     passing to html.sanitize.\n   */\n  function makeTagPolicy(\n    opt_naiveUriRewriter, opt_nmTokenPolicy, opt_logger) {\n    return function(tagName, attribs) {\n      if (!(html4.ELEMENTS[tagName] & html4.eflags['UNSAFE'])) {\n        return {\n          'attribs': sanitizeAttribs(tagName, attribs,\n            opt_naiveUriRewriter, opt_nmTokenPolicy, opt_logger)\n        };\n      } else {\n        if (opt_logger) {\n          log(opt_logger, tagName, undefined, undefined, undefined);\n        }\n      }\n    };\n  }\n\n  /**\n   * Sanitizes HTML tags and attributes according to a given policy.\n   * @param {string} inputHtml The HTML to sanitize.\n   * @param {function(string, Array.<?string>)} tagPolicy A function that\n   *     decides which tags to accept and sanitizes their attributes (see\n   *     makeHtmlSanitizer above for details).\n   * @return {string} The sanitized HTML.\n   */\n  function sanitizeWithPolicy(inputHtml, tagPolicy) {\n    var outputArray = [];\n    makeHtmlSanitizer(tagPolicy)(inputHtml, outputArray);\n    return outputArray.join('');\n  }\n\n  /**\n   * Strips unsafe tags and attributes from HTML.\n   * @param {string} inputHtml The HTML to sanitize.\n   * @param {?function(?string): ?string} opt_naiveUriRewriter A transform to\n   *     apply to URI attributes.  If not given, URI attributes are deleted.\n   * @param {function(?string): ?string} opt_nmTokenPolicy A transform to apply\n   *     to attributes containing HTML names, element IDs, and space-separated\n   *     lists of classes.  If not given, such attributes are left unchanged.\n   */\n  function sanitize(inputHtml,\n    opt_naiveUriRewriter, opt_nmTokenPolicy, opt_logger) {\n    var tagPolicy = makeTagPolicy(\n      opt_naiveUriRewriter, opt_nmTokenPolicy, opt_logger);\n    return sanitizeWithPolicy(inputHtml, tagPolicy);\n  }\n\n  // Export both quoted and unquoted names for Closure linkage.\n  var html = {};\n  html.escapeAttrib = html['escapeAttrib'] = escapeAttrib;\n  html.makeHtmlSanitizer = html['makeHtmlSanitizer'] = makeHtmlSanitizer;\n  html.makeSaxParser = html['makeSaxParser'] = makeSaxParser;\n  html.makeTagPolicy = html['makeTagPolicy'] = makeTagPolicy;\n  html.normalizeRCData = html['normalizeRCData'] = normalizeRCData;\n  html.sanitize = html['sanitize'] = sanitize;\n  html.sanitizeAttribs = html['sanitizeAttribs'] = sanitizeAttribs;\n  html.sanitizeWithPolicy = html['sanitizeWithPolicy'] = sanitizeWithPolicy;\n  html.unescapeEntities = html['unescapeEntities'] = unescapeEntities;\n  return html;\n})(html4);\n\nvar html_sanitize = html['sanitize'];\n\n// Loosen restrictions of Caja's\n// html-sanitizer to allow for styling\nhtml4.ATTRIBS['*::style'] = 0;\nhtml4.ELEMENTS['style'] = 0;\nhtml4.ATTRIBS['a::target'] = 0;\nhtml4.ELEMENTS['video'] = 0;\nhtml4.ATTRIBS['video::src'] = 0;\nhtml4.ATTRIBS['video::poster'] = 0;\nhtml4.ATTRIBS['video::controls'] = 0;\nhtml4.ELEMENTS['audio'] = 0;\nhtml4.ATTRIBS['audio::src'] = 0;\nhtml4.ATTRIBS['video::autoplay'] = 0;\nhtml4.ATTRIBS['video::controls'] = 0;\n\nif (typeof module !== 'undefined') {\n    module.exports = html_sanitize;\n}\n","/*!\n * mustache.js - Logic-less {{mustache}} templates with JavaScript\n * http://github.com/janl/mustache.js\n */\n\n/*global define: false Mustache: true*/\n\n(function defineMustache (global, factory) {\n  if (typeof exports === 'object' && exports && typeof exports.nodeName !== 'string') {\n    factory(exports); // CommonJS\n  } else if (typeof define === 'function' && define.amd) {\n    define(['exports'], factory); // AMD\n  } else {\n    global.Mustache = {};\n    factory(global.Mustache); // script, wsh, asp\n  }\n}(this, function mustacheFactory (mustache) {\n\n  var objectToString = Object.prototype.toString;\n  var isArray = Array.isArray || function isArrayPolyfill (object) {\n    return objectToString.call(object) === '[object Array]';\n  };\n\n  function isFunction (object) {\n    return typeof object === 'function';\n  }\n\n  /**\n   * More correct typeof string handling array\n   * which normally returns typeof 'object'\n   */\n  function typeStr (obj) {\n    return isArray(obj) ? 'array' : typeof obj;\n  }\n\n  function escapeRegExp (string) {\n    return string.replace(/[\\-\\[\\]{}()*+?.,\\\\\\^$|#\\s]/g, '\\\\$&');\n  }\n\n  /**\n   * Null safe way of checking whether or not an object,\n   * including its prototype, has a given property\n   */\n  function hasProperty (obj, propName) {\n    return obj != null && typeof obj === 'object' && (propName in obj);\n  }\n\n  /**\n   * Safe way of detecting whether or not the given thing is a primitive and\n   * whether it has the given property\n   */\n  function primitiveHasOwnProperty (primitive, propName) {  \n    return (\n      primitive != null\n      && typeof primitive !== 'object'\n      && primitive.hasOwnProperty\n      && primitive.hasOwnProperty(propName)\n    );\n  }\n\n  // Workaround for https://issues.apache.org/jira/browse/COUCHDB-577\n  // See https://github.com/janl/mustache.js/issues/189\n  var regExpTest = RegExp.prototype.test;\n  function testRegExp (re, string) {\n    return regExpTest.call(re, string);\n  }\n\n  var nonSpaceRe = /\\S/;\n  function isWhitespace (string) {\n    return !testRegExp(nonSpaceRe, string);\n  }\n\n  var entityMap = {\n    '&': '&amp;',\n    '<': '&lt;',\n    '>': '&gt;',\n    '\"': '&quot;',\n    \"'\": '&#39;',\n    '/': '&#x2F;',\n    '`': '&#x60;',\n    '=': '&#x3D;'\n  };\n\n  function escapeHtml (string) {\n    return String(string).replace(/[&<>\"'`=\\/]/g, function fromEntityMap (s) {\n      return entityMap[s];\n    });\n  }\n\n  var whiteRe = /\\s*/;\n  var spaceRe = /\\s+/;\n  var equalsRe = /\\s*=/;\n  var curlyRe = /\\s*\\}/;\n  var tagRe = /#|\\^|\\/|>|\\{|&|=|!/;\n\n  /**\n   * Breaks up the given `template` string into a tree of tokens. If the `tags`\n   * argument is given here it must be an array with two string values: the\n   * opening and closing tags used in the template (e.g. [ \"<%\", \"%>\" ]). Of\n   * course, the default is to use mustaches (i.e. mustache.tags).\n   *\n   * A token is an array with at least 4 elements. The first element is the\n   * mustache symbol that was used inside the tag, e.g. \"#\" or \"&\". If the tag\n   * did not contain a symbol (i.e. {{myValue}}) this element is \"name\". For\n   * all text that appears outside a symbol this element is \"text\".\n   *\n   * The second element of a token is its \"value\". For mustache tags this is\n   * whatever else was inside the tag besides the opening symbol. For text tokens\n   * this is the text itself.\n   *\n   * The third and fourth elements of the token are the start and end indices,\n   * respectively, of the token in the original template.\n   *\n   * Tokens that are the root node of a subtree contain two more elements: 1) an\n   * array of tokens in the subtree and 2) the index in the original template at\n   * which the closing tag for that section begins.\n   */\n  function parseTemplate (template, tags) {\n    if (!template)\n      return [];\n\n    var sections = [];     // Stack to hold section tokens\n    var tokens = [];       // Buffer to hold the tokens\n    var spaces = [];       // Indices of whitespace tokens on the current line\n    var hasTag = false;    // Is there a {{tag}} on the current line?\n    var nonSpace = false;  // Is there a non-space char on the current line?\n\n    // Strips all whitespace tokens array for the current line\n    // if there was a {{#tag}} on it and otherwise only space.\n    function stripSpace () {\n      if (hasTag && !nonSpace) {\n        while (spaces.length)\n          delete tokens[spaces.pop()];\n      } else {\n        spaces = [];\n      }\n\n      hasTag = false;\n      nonSpace = false;\n    }\n\n    var openingTagRe, closingTagRe, closingCurlyRe;\n    function compileTags (tagsToCompile) {\n      if (typeof tagsToCompile === 'string')\n        tagsToCompile = tagsToCompile.split(spaceRe, 2);\n\n      if (!isArray(tagsToCompile) || tagsToCompile.length !== 2)\n        throw new Error('Invalid tags: ' + tagsToCompile);\n\n      openingTagRe = new RegExp(escapeRegExp(tagsToCompile[0]) + '\\\\s*');\n      closingTagRe = new RegExp('\\\\s*' + escapeRegExp(tagsToCompile[1]));\n      closingCurlyRe = new RegExp('\\\\s*' + escapeRegExp('}' + tagsToCompile[1]));\n    }\n\n    compileTags(tags || mustache.tags);\n\n    var scanner = new Scanner(template);\n\n    var start, type, value, chr, token, openSection;\n    while (!scanner.eos()) {\n      start = scanner.pos;\n\n      // Match any text between tags.\n      value = scanner.scanUntil(openingTagRe);\n\n      if (value) {\n        for (var i = 0, valueLength = value.length; i < valueLength; ++i) {\n          chr = value.charAt(i);\n\n          if (isWhitespace(chr)) {\n            spaces.push(tokens.length);\n          } else {\n            nonSpace = true;\n          }\n\n          tokens.push([ 'text', chr, start, start + 1 ]);\n          start += 1;\n\n          // Check for whitespace on the current line.\n          if (chr === '\\n')\n            stripSpace();\n        }\n      }\n\n      // Match the opening tag.\n      if (!scanner.scan(openingTagRe))\n        break;\n\n      hasTag = true;\n\n      // Get the tag type.\n      type = scanner.scan(tagRe) || 'name';\n      scanner.scan(whiteRe);\n\n      // Get the tag value.\n      if (type === '=') {\n        value = scanner.scanUntil(equalsRe);\n        scanner.scan(equalsRe);\n        scanner.scanUntil(closingTagRe);\n      } else if (type === '{') {\n        value = scanner.scanUntil(closingCurlyRe);\n        scanner.scan(curlyRe);\n        scanner.scanUntil(closingTagRe);\n        type = '&';\n      } else {\n        value = scanner.scanUntil(closingTagRe);\n      }\n\n      // Match the closing tag.\n      if (!scanner.scan(closingTagRe))\n        throw new Error('Unclosed tag at ' + scanner.pos);\n\n      token = [ type, value, start, scanner.pos ];\n      tokens.push(token);\n\n      if (type === '#' || type === '^') {\n        sections.push(token);\n      } else if (type === '/') {\n        // Check section nesting.\n        openSection = sections.pop();\n\n        if (!openSection)\n          throw new Error('Unopened section \"' + value + '\" at ' + start);\n\n        if (openSection[1] !== value)\n          throw new Error('Unclosed section \"' + openSection[1] + '\" at ' + start);\n      } else if (type === 'name' || type === '{' || type === '&') {\n        nonSpace = true;\n      } else if (type === '=') {\n        // Set the tags for the next time around.\n        compileTags(value);\n      }\n    }\n\n    // Make sure there are no open sections when we're done.\n    openSection = sections.pop();\n\n    if (openSection)\n      throw new Error('Unclosed section \"' + openSection[1] + '\" at ' + scanner.pos);\n\n    return nestTokens(squashTokens(tokens));\n  }\n\n  /**\n   * Combines the values of consecutive text tokens in the given `tokens` array\n   * to a single token.\n   */\n  function squashTokens (tokens) {\n    var squashedTokens = [];\n\n    var token, lastToken;\n    for (var i = 0, numTokens = tokens.length; i < numTokens; ++i) {\n      token = tokens[i];\n\n      if (token) {\n        if (token[0] === 'text' && lastToken && lastToken[0] === 'text') {\n          lastToken[1] += token[1];\n          lastToken[3] = token[3];\n        } else {\n          squashedTokens.push(token);\n          lastToken = token;\n        }\n      }\n    }\n\n    return squashedTokens;\n  }\n\n  /**\n   * Forms the given array of `tokens` into a nested tree structure where\n   * tokens that represent a section have two additional items: 1) an array of\n   * all tokens that appear in that section and 2) the index in the original\n   * template that represents the end of that section.\n   */\n  function nestTokens (tokens) {\n    var nestedTokens = [];\n    var collector = nestedTokens;\n    var sections = [];\n\n    var token, section;\n    for (var i = 0, numTokens = tokens.length; i < numTokens; ++i) {\n      token = tokens[i];\n\n      switch (token[0]) {\n        case '#':\n        case '^':\n          collector.push(token);\n          sections.push(token);\n          collector = token[4] = [];\n          break;\n        case '/':\n          section = sections.pop();\n          section[5] = token[2];\n          collector = sections.length > 0 ? sections[sections.length - 1][4] : nestedTokens;\n          break;\n        default:\n          collector.push(token);\n      }\n    }\n\n    return nestedTokens;\n  }\n\n  /**\n   * A simple string scanner that is used by the template parser to find\n   * tokens in template strings.\n   */\n  function Scanner (string) {\n    this.string = string;\n    this.tail = string;\n    this.pos = 0;\n  }\n\n  /**\n   * Returns `true` if the tail is empty (end of string).\n   */\n  Scanner.prototype.eos = function eos () {\n    return this.tail === '';\n  };\n\n  /**\n   * Tries to match the given regular expression at the current position.\n   * Returns the matched text if it can match, the empty string otherwise.\n   */\n  Scanner.prototype.scan = function scan (re) {\n    var match = this.tail.match(re);\n\n    if (!match || match.index !== 0)\n      return '';\n\n    var string = match[0];\n\n    this.tail = this.tail.substring(string.length);\n    this.pos += string.length;\n\n    return string;\n  };\n\n  /**\n   * Skips all text until the given regular expression can be matched. Returns\n   * the skipped string, which is the entire tail if no match can be made.\n   */\n  Scanner.prototype.scanUntil = function scanUntil (re) {\n    var index = this.tail.search(re), match;\n\n    switch (index) {\n      case -1:\n        match = this.tail;\n        this.tail = '';\n        break;\n      case 0:\n        match = '';\n        break;\n      default:\n        match = this.tail.substring(0, index);\n        this.tail = this.tail.substring(index);\n    }\n\n    this.pos += match.length;\n\n    return match;\n  };\n\n  /**\n   * Represents a rendering context by wrapping a view object and\n   * maintaining a reference to the parent context.\n   */\n  function Context (view, parentContext) {\n    this.view = view;\n    this.cache = { '.': this.view };\n    this.parent = parentContext;\n  }\n\n  /**\n   * Creates a new context using the given view with this context\n   * as the parent.\n   */\n  Context.prototype.push = function push (view) {\n    return new Context(view, this);\n  };\n\n  /**\n   * Returns the value of the given name in this context, traversing\n   * up the context hierarchy if the value is absent in this context's view.\n   */\n  Context.prototype.lookup = function lookup (name) {\n    var cache = this.cache;\n\n    var value;\n    if (cache.hasOwnProperty(name)) {\n      value = cache[name];\n    } else {\n      var context = this, intermediateValue, names, index, lookupHit = false;\n\n      while (context) {\n        if (name.indexOf('.') > 0) {\n          intermediateValue = context.view;\n          names = name.split('.');\n          index = 0;\n\n          /**\n           * Using the dot notion path in `name`, we descend through the\n           * nested objects.\n           *\n           * To be certain that the lookup has been successful, we have to\n           * check if the last object in the path actually has the property\n           * we are looking for. We store the result in `lookupHit`.\n           *\n           * This is specially necessary for when the value has been set to\n           * `undefined` and we want to avoid looking up parent contexts.\n           *\n           * In the case where dot notation is used, we consider the lookup\n           * to be successful even if the last \"object\" in the path is\n           * not actually an object but a primitive (e.g., a string, or an\n           * integer), because it is sometimes useful to access a property\n           * of an autoboxed primitive, such as the length of a string.\n           **/\n          while (intermediateValue != null && index < names.length) {\n            if (index === names.length - 1)\n              lookupHit = (\n                hasProperty(intermediateValue, names[index]) \n                || primitiveHasOwnProperty(intermediateValue, names[index])\n              );\n\n            intermediateValue = intermediateValue[names[index++]];\n          }\n        } else {\n          intermediateValue = context.view[name];\n\n          /**\n           * Only checking against `hasProperty`, which always returns `false` if\n           * `context.view` is not an object. Deliberately omitting the check\n           * against `primitiveHasOwnProperty` if dot notation is not used.\n           *\n           * Consider this example:\n           * ```\n           * Mustache.render(\"The length of a football field is {{#length}}{{length}}{{/length}}.\", {length: \"100 yards\"})\n           * ```\n           *\n           * If we were to check also against `primitiveHasOwnProperty`, as we do\n           * in the dot notation case, then render call would return:\n           *\n           * \"The length of a football field is 9.\"\n           *\n           * rather than the expected:\n           *\n           * \"The length of a football field is 100 yards.\"\n           **/\n          lookupHit = hasProperty(context.view, name);\n        }\n\n        if (lookupHit) {\n          value = intermediateValue;\n          break;\n        }\n\n        context = context.parent;\n      }\n\n      cache[name] = value;\n    }\n\n    if (isFunction(value))\n      value = value.call(this.view);\n\n    return value;\n  };\n\n  /**\n   * A Writer knows how to take a stream of tokens and render them to a\n   * string, given a context. It also maintains a cache of templates to\n   * avoid the need to parse the same template twice.\n   */\n  function Writer () {\n    this.cache = {};\n  }\n\n  /**\n   * Clears all cached templates in this writer.\n   */\n  Writer.prototype.clearCache = function clearCache () {\n    this.cache = {};\n  };\n\n  /**\n   * Parses and caches the given `template` according to the given `tags` or\n   * `mustache.tags` if `tags` is omitted,  and returns the array of tokens\n   * that is generated from the parse.\n   */\n  Writer.prototype.parse = function parse (template, tags) {\n    var cache = this.cache;\n    var cacheKey = template + ':' + (tags || mustache.tags).join(':');\n    var tokens = cache[cacheKey];\n\n    if (tokens == null)\n      tokens = cache[cacheKey] = parseTemplate(template, tags);\n\n    return tokens;\n  };\n\n  /**\n   * High-level method that is used to render the given `template` with\n   * the given `view`.\n   *\n   * The optional `partials` argument may be an object that contains the\n   * names and templates of partials that are used in the template. It may\n   * also be a function that is used to load partial templates on the fly\n   * that takes a single argument: the name of the partial.\n   *\n   * If the optional `tags` argument is given here it must be an array with two\n   * string values: the opening and closing tags used in the template (e.g.\n   * [ \"<%\", \"%>\" ]). The default is to mustache.tags.\n   */\n  Writer.prototype.render = function render (template, view, partials, tags) {\n    var tokens = this.parse(template, tags);\n    var context = (view instanceof Context) ? view : new Context(view);\n    return this.renderTokens(tokens, context, partials, template, tags);\n  };\n\n  /**\n   * Low-level method that renders the given array of `tokens` using\n   * the given `context` and `partials`.\n   *\n   * Note: The `originalTemplate` is only ever used to extract the portion\n   * of the original template that was contained in a higher-order section.\n   * If the template doesn't use higher-order sections, this argument may\n   * be omitted.\n   */\n  Writer.prototype.renderTokens = function renderTokens (tokens, context, partials, originalTemplate, tags) {\n    var buffer = '';\n\n    var token, symbol, value;\n    for (var i = 0, numTokens = tokens.length; i < numTokens; ++i) {\n      value = undefined;\n      token = tokens[i];\n      symbol = token[0];\n\n      if (symbol === '#') value = this.renderSection(token, context, partials, originalTemplate);\n      else if (symbol === '^') value = this.renderInverted(token, context, partials, originalTemplate);\n      else if (symbol === '>') value = this.renderPartial(token, context, partials, tags);\n      else if (symbol === '&') value = this.unescapedValue(token, context);\n      else if (symbol === 'name') value = this.escapedValue(token, context);\n      else if (symbol === 'text') value = this.rawValue(token);\n\n      if (value !== undefined)\n        buffer += value;\n    }\n\n    return buffer;\n  };\n\n  Writer.prototype.renderSection = function renderSection (token, context, partials, originalTemplate) {\n    var self = this;\n    var buffer = '';\n    var value = context.lookup(token[1]);\n\n    // This function is used to render an arbitrary template\n    // in the current context by higher-order sections.\n    function subRender (template) {\n      return self.render(template, context, partials);\n    }\n\n    if (!value) return;\n\n    if (isArray(value)) {\n      for (var j = 0, valueLength = value.length; j < valueLength; ++j) {\n        buffer += this.renderTokens(token[4], context.push(value[j]), partials, originalTemplate);\n      }\n    } else if (typeof value === 'object' || typeof value === 'string' || typeof value === 'number') {\n      buffer += this.renderTokens(token[4], context.push(value), partials, originalTemplate);\n    } else if (isFunction(value)) {\n      if (typeof originalTemplate !== 'string')\n        throw new Error('Cannot use higher-order sections without the original template');\n\n      // Extract the portion of the original template that the section contains.\n      value = value.call(context.view, originalTemplate.slice(token[3], token[5]), subRender);\n\n      if (value != null)\n        buffer += value;\n    } else {\n      buffer += this.renderTokens(token[4], context, partials, originalTemplate);\n    }\n    return buffer;\n  };\n\n  Writer.prototype.renderInverted = function renderInverted (token, context, partials, originalTemplate) {\n    var value = context.lookup(token[1]);\n\n    // Use JavaScript's definition of falsy. Include empty arrays.\n    // See https://github.com/janl/mustache.js/issues/186\n    if (!value || (isArray(value) && value.length === 0))\n      return this.renderTokens(token[4], context, partials, originalTemplate);\n  };\n\n  Writer.prototype.renderPartial = function renderPartial (token, context, partials, tags) {\n    if (!partials) return;\n\n    var value = isFunction(partials) ? partials(token[1]) : partials[token[1]];\n    if (value != null)\n      return this.renderTokens(this.parse(value, tags), context, partials, value);\n  };\n\n  Writer.prototype.unescapedValue = function unescapedValue (token, context) {\n    var value = context.lookup(token[1]);\n    if (value != null)\n      return value;\n  };\n\n  Writer.prototype.escapedValue = function escapedValue (token, context) {\n    var value = context.lookup(token[1]);\n    if (value != null)\n      return mustache.escape(value);\n  };\n\n  Writer.prototype.rawValue = function rawValue (token) {\n    return token[1];\n  };\n\n  mustache.name = 'mustache.js';\n  mustache.version = '3.0.1';\n  mustache.tags = [ '{{', '}}' ];\n\n  // All high-level mustache.* functions use this writer.\n  var defaultWriter = new Writer();\n\n  /**\n   * Clears all cached templates in the default writer.\n   */\n  mustache.clearCache = function clearCache () {\n    return defaultWriter.clearCache();\n  };\n\n  /**\n   * Parses and caches the given template in the default writer and returns the\n   * array of tokens it contains. Doing this ahead of time avoids the need to\n   * parse templates on the fly as they are rendered.\n   */\n  mustache.parse = function parse (template, tags) {\n    return defaultWriter.parse(template, tags);\n  };\n\n  /**\n   * Renders the `template` with the given `view` and `partials` using the\n   * default writer. If the optional `tags` argument is given here it must be an\n   * array with two string values: the opening and closing tags used in the\n   * template (e.g. [ \"<%\", \"%>\" ]). The default is to mustache.tags.\n   */\n  mustache.render = function render (template, view, partials, tags) {\n    if (typeof template !== 'string') {\n      throw new TypeError('Invalid template! Template should be a \"string\" ' +\n                          'but \"' + typeStr(template) + '\" was given as the first ' +\n                          'argument for mustache#render(template, view, partials)');\n    }\n\n    return defaultWriter.render(template, view, partials, tags);\n  };\n\n  // This is here for backwards compatibility with 0.4.x.,\n  /*eslint-disable */ // eslint wants camel cased function name\n  mustache.to_html = function to_html (template, view, partials, send) {\n    /*eslint-enable*/\n\n    var result = mustache.render(template, view, partials);\n\n    if (isFunction(send)) {\n      send(result);\n    } else {\n      return result;\n    }\n  };\n\n  // Export the escaping function so that the user may override it.\n  // See https://github.com/janl/mustache.js/issues/244\n  mustache.escape = escapeHtml;\n\n  // Export these mainly for testing, but also for advanced usage.\n  mustache.Scanner = Scanner;\n  mustache.Context = Context;\n  mustache.Writer = Writer;\n\n  return mustache;\n}));\n","'use strict';\n\nmodule.exports = {\n    HTTP_URL: 'http://api.mapbox.com',\n    HTTPS_URL: 'https://api.mapbox.com',\n    FORCE_HTTPS: true,\n    REQUIRE_ACCESS_TOKEN: true,\n    TEMPLATE_STYLES: {\n        'mapbox.dark': 'mapbox/dark-v10',\n        'mapbox.light': 'mapbox/light-v10',\n        'mapbox.osm-bright': 'mapbox/bright-v9',\n        'mapbox.outdoors': 'mapbox/outdoors-v11', \n        'mapbox.satellite': 'mapbox/satellite-v9',\n        'mapbox.streets': 'mapbox/streets-v11', \n        'mapbox.streets-basic': 'mapbox/basic-v9',\n        'mapbox.streets-satellite': 'mapbox/satellite-streets-v11'\n    }\n};\n","'use strict';\n\nvar util = require('./util'),\n    format_url = require('./format_url'),\n    request = require('./request'),\n    marker = require('./marker'),\n    simplestyle = require('./simplestyle');\n\n// # featureLayer\n//\n// A layer of features, loaded from Mapbox or else. Adds the ability\n// to reset features, filter them, and load them from a GeoJSON URL.\nvar FeatureLayer = L.FeatureGroup.extend({\n    options: {\n        filter: function() { return true; },\n        sanitizer: require('@mapbox/sanitize-caja'),\n        style: simplestyle.style,\n        popupOptions: { closeButton: false }\n    },\n\n    initialize: function(_, options) {\n        L.setOptions(this, options);\n\n        this._layers = {};\n\n        if (typeof _ === 'string') {\n            util.idUrl(_, this);\n        // javascript object of TileJSON data\n        } else if (_ && typeof _ === 'object') {\n            this.setGeoJSON(_);\n        }\n    },\n\n    setGeoJSON: function(_) {\n        this._geojson = _;\n        this.clearLayers();\n        this._initialize(_);\n        return this;\n    },\n\n    getGeoJSON: function() {\n        return this._geojson;\n    },\n\n    loadURL: function(url) {\n        if (this._request && 'abort' in this._request) this._request.abort();\n        this._request = request(url, L.bind(function(err, json) {\n            this._request = null;\n            if (err && err.type !== 'abort') {\n                util.log('could not load features at ' + url);\n                this.fire('error', {error: err});\n            } else if (json) {\n                this.setGeoJSON(json);\n                this.fire('ready');\n            }\n        }, this));\n        return this;\n    },\n\n    loadID: function(id) {\n        return this.loadURL(format_url('/v4/' + id + '/features.json', this.options.accessToken));\n    },\n\n    setFilter: function(_) {\n        this.options.filter = _;\n        if (this._geojson) {\n            this.clearLayers();\n            this._initialize(this._geojson);\n        }\n        return this;\n    },\n\n    getFilter: function() {\n        return this.options.filter;\n    },\n\n    _initialize: function(json) {\n        var features = L.Util.isArray(json) ? json : json.features,\n            i, len;\n\n        if (features) {\n            for (i = 0, len = features.length; i < len; i++) {\n                // Only add this if geometry or geometries are set and not null\n                if (features[i].geometries || features[i].geometry || features[i].features) {\n                    this._initialize(features[i]);\n                }\n            }\n        } else if (this.options.filter(json)) {\n\n            var opts = {accessToken: this.options.accessToken},\n                pointToLayer = this.options.pointToLayer || function(feature, latlon) {\n                  return marker.style(feature, latlon, opts);\n                },\n                layer = L.GeoJSON.geometryToLayer(json, {\n                    pointToLayer: pointToLayer\n                }),\n                popupHtml = marker.createPopup(json, this.options.sanitizer),\n                style = this.options.style,\n                defaultStyle = style === simplestyle.style;\n\n            if (style && 'setStyle' in layer &&\n                // if the style method is the simplestyle default, then\n                // never style L.Circle or L.CircleMarker because\n                // simplestyle has no rules over them, only over geometry\n                // primitives directly from GeoJSON\n                (!(defaultStyle && (layer instanceof L.Circle ||\n                  layer instanceof L.CircleMarker)))) {\n                if (typeof style === 'function') {\n                    style = style(json);\n                }\n                layer.setStyle(style);\n            }\n\n            layer.feature = json;\n\n            if (popupHtml) {\n                layer.bindPopup(popupHtml, this.options.popupOptions);\n            }\n\n            this.addLayer(layer);\n        }\n    }\n});\n\nmodule.exports.FeatureLayer = FeatureLayer;\n\nmodule.exports.featureLayer = function(_, options) {\n    return new FeatureLayer(_, options);\n};\n","'use strict';\n\nvar Feedback = L.Class.extend({\n    includes: L.Evented.prototype || L.Mixin.Events,\n    data: {},\n    record: function(data) {\n        L.extend(this.data, data);\n        this.fire('change');\n    }\n});\n\nmodule.exports = new Feedback();\n","'use strict';\n\nvar config = require('./config'),\n    version = require('../package.json').version;\n\nmodule.exports = function(path, accessToken) {\n    accessToken = accessToken || L.mapbox.accessToken;\n\n    if (!accessToken && config.REQUIRE_ACCESS_TOKEN) {\n        throw new Error('An API access token is required to use Mapbox.js. ' +\n            'See https://www.mapbox.com/mapbox.js/api/v' + version + '/api-access-tokens/');\n    }\n\n    var url = (document.location.protocol === 'https:' || config.FORCE_HTTPS) ? config.HTTPS_URL : config.HTTP_URL;\n    url = url.replace(/\\/v4$/, '');\n    url += path;\n\n    if (config.REQUIRE_ACCESS_TOKEN) {\n        if (accessToken[0] === 's') {\n            throw new Error('Use a public access token (pk.*) with Mapbox.js, not a secret access token (sk.*). ' +\n                'See https://www.mapbox.com/mapbox.js/api/v' + version + '/api-access-tokens/');\n        }\n\n        url += url.indexOf('?') !== -1 ? '&access_token=' : '?access_token=';\n        url += accessToken;\n    }\n\n    return url;\n};\n\nmodule.exports.tileJSON = function(urlOrMapID, accessToken) {\n\n    if (urlOrMapID.indexOf('mapbox://styles') === 0) {\n        throw new Error('Styles created with Mapbox Studio need to be used with ' +\n            'L.mapbox.styleLayer, not L.mapbox.tileLayer');\n    }\n\n    if (urlOrMapID.indexOf('/') !== -1) return urlOrMapID;\n\n    var url;\n    if (urlOrMapID in config.TEMPLATE_STYLES) {\n        url = module.exports('/styles/v1/' + config.TEMPLATE_STYLES[urlOrMapID], accessToken);\n    } else {\n        url = module.exports('/v4/' + urlOrMapID + '.json', accessToken);\n    }\n\n    // TileJSON requests need a secure flag appended to their URLs so\n    // that the server knows to send SSL-ified resource references.\n    if (url.indexOf('https') === 0)\n        url += '&secure';\n\n    return url;\n};\n\n\nmodule.exports.style = function(styleURL, accessToken) {\n    if (styleURL.indexOf('mapbox://styles/') === -1) throw new Error('Incorrectly formatted Mapbox style at ' + styleURL);\n\n    var ownerIDStyle = styleURL.split('mapbox://styles/')[1];\n    var url = module.exports('/styles/v1/' + ownerIDStyle, accessToken);\n\n    return url;\n};\n","'use strict';\n\nvar util = require('./util'),\n    format_url = require('./format_url'),\n    feedback = require('./feedback'),\n    request = require('./request');\n\n// Low-level geocoding interface - wraps specific API calls and their\n// return values.\nmodule.exports = function(url, options) {\n    if (!options) options = {};\n    var geocoder = {};\n\n    util.strict(url, 'string');\n\n    if (url.indexOf('/') === -1) {\n        url = format_url('/geocoding/v5/' + url + '/{query}.json', options.accessToken, 5);\n    }\n\n    function roundTo(latLng, precision) {\n        var mult = Math.pow(10, precision);\n        latLng.lat = Math.round(latLng.lat * mult) / mult;\n        latLng.lng = Math.round(latLng.lng * mult) / mult;\n        return latLng;\n    }\n\n    geocoder.getURL = function() {\n        return url;\n    };\n\n    geocoder.queryURL = function(_) {\n        var isArray = L.Util.isArray;\n        var isObject = !(isArray(_) || typeof _ === 'string'),\n            query = isObject ? _.query : _;\n\n        if (isArray(query)) {\n            var parts = [];\n            for (var i = 0; i < query.length; i++) {\n                parts[i] = encodeURIComponent(query[i]);\n            }\n            query = parts.join(';');\n        } else {\n            query = encodeURIComponent(query);\n        }\n\n        feedback.record({ geocoding: query });\n\n        var url = L.Util.template(geocoder.getURL(), {query: query});\n\n        if (isObject) {\n            if (_.types) {\n                if (isArray(_.types)) {\n                    url += '&types=' + _.types.join();\n                } else {\n                    url += '&types=' + _.types;\n                }\n            }\n\n            if (_.country) {\n                if (isArray(_.country)) {\n                    url += '&country=' + _.country.join();\n                } else {\n                    url += '&country=' + _.country;\n                }\n            }\n\n            if (_.bbox) {\n                if (isArray(_.bbox)) {\n                    url += '&bbox=' + _.bbox.join();\n                } else {\n                    url += '&bbox=' + _.bbox;\n                }\n            }\n\n            if (_.proximity) {\n                var proximity = roundTo(L.latLng(_.proximity), 3);\n                url += '&proximity=' + proximity.lng + ',' + proximity.lat;\n            }\n\n            if (typeof _.autocomplete === 'boolean') {\n                url += '&autocomplete=' + _.autocomplete;\n            }\n        }\n\n        return url;\n    };\n\n    geocoder.query = function(_, callback) {\n        util.strict(callback, 'function');\n\n        request(geocoder.queryURL(_), function(err, json) {\n            if (json && (json.length || json.features)) {\n                var res = {\n                    results: json\n                };\n                if (json.features && json.features.length) {\n                    res.latlng = [\n                        json.features[0].center[1],\n                        json.features[0].center[0]];\n\n                    if (json.features[0].bbox) {\n                        res.bounds = json.features[0].bbox;\n                        res.lbounds = util.lbounds(res.bounds);\n                    }\n                }\n                callback(null, res);\n            } else callback(err || true);\n        });\n\n        return geocoder;\n    };\n\n    // a reverse geocode:\n    //\n    //  geocoder.reverseQuery([80, 20])\n    geocoder.reverseQuery = function(_, callback) {\n        var q = '';\n\n        // sort through different ways people represent lat and lon pairs\n        function normalize(x) {\n            var latLng;\n            if (x.lat !== undefined && x.lng !== undefined) {\n                latLng = L.latLng(x.lat, x.lng);\n            } else if (x.lat !== undefined && x.lon !== undefined) {\n                latLng = L.latLng(x.lat, x.lon);\n            } else {\n                latLng = L.latLng(x[1], x[0]);\n            }\n            latLng = roundTo(latLng, 5);\n            return latLng.lng + ',' + latLng.lat;\n        }\n\n        if (_.length && _[0].length) {\n            for (var i = 0, pts = []; i < _.length; i++) {\n                pts.push(normalize(_[i]));\n            }\n            q = pts.join(';');\n        } else {\n            q = normalize(_);\n        }\n\n        request(geocoder.queryURL(q), function(err, json) {\n            callback(err, json);\n        });\n\n        return geocoder;\n    };\n\n    return geocoder;\n};\n","'use strict';\n\nvar geocoder = require('./geocoder'),\n    util = require('./util');\n\nvar GeocoderControl = L.Control.extend({\n    includes: L.Evented.prototype || L.Mixin.Events,\n\n    options: {\n        proximity: true,\n        position: 'topleft',\n        pointZoom: 16,\n        keepOpen: false,\n        autocomplete: false,\n        queryOptions: {}\n    },\n\n    initialize: function(_, options) {\n        L.Util.setOptions(this, options);\n        this.setURL(_);\n        this._updateSubmit = L.bind(this._updateSubmit, this);\n        this._updateAutocomplete = L.bind(this._updateAutocomplete, this);\n        this._chooseResult = L.bind(this._chooseResult, this);\n    },\n\n    setURL: function(_) {\n        this.geocoder = geocoder(_, {\n            accessToken: this.options.accessToken\n        });\n        return this;\n    },\n\n    getURL: function() {\n        return this.geocoder.getURL();\n    },\n\n    setID: function(_) {\n        return this.setURL(_);\n    },\n\n    setTileJSON: function(_) {\n        return this.setURL(_.geocoder);\n    },\n\n    _toggle: function(e) {\n        if (e) L.DomEvent.stop(e);\n        if (L.DomUtil.hasClass(this._container, 'active')) {\n            L.DomUtil.removeClass(this._container, 'active');\n            this._results.innerHTML = '';\n            this._input.blur();\n        } else {\n            L.DomUtil.addClass(this._container, 'active');\n            this._input.focus();\n            this._input.select();\n        }\n    },\n\n    _closeIfOpen: function() {\n        if (L.DomUtil.hasClass(this._container, 'active') &&\n            !this.options.keepOpen) {\n            L.DomUtil.removeClass(this._container, 'active');\n            this._results.innerHTML = '';\n            this._input.blur();\n        }\n    },\n\n    onAdd: function(map) {\n\n        var container = L.DomUtil.create('div', 'leaflet-control-mapbox-geocoder leaflet-bar leaflet-control'),\n            link = L.DomUtil.create('a', 'leaflet-control-mapbox-geocoder-toggle mapbox-icon mapbox-icon-geocoder', container),\n            results = L.DomUtil.create('div', 'leaflet-control-mapbox-geocoder-results', container),\n            wrap = L.DomUtil.create('div', 'leaflet-control-mapbox-geocoder-wrap', container),\n            form = L.DomUtil.create('form', 'leaflet-control-mapbox-geocoder-form', wrap),\n            input = L.DomUtil.create('input', '', form);\n\n        link.href = '#';\n        link.innerHTML = '&nbsp;';\n\n        input.type = 'text';\n        input.setAttribute('placeholder', 'Search');\n\n        L.DomEvent.addListener(form, 'submit', this._geocode, this);\n        L.DomEvent.addListener(input, 'keyup', this._autocomplete, this);\n        L.DomEvent.disableClickPropagation(container);\n\n        this._map = map;\n        this._results = results;\n        this._input = input;\n        this._form = form;\n\n        if (this.options.keepOpen) {\n            L.DomUtil.addClass(container, 'active');\n        } else {\n            this._map.on('click', this._closeIfOpen, this);\n            L.DomEvent.addListener(link, 'click', this._toggle, this);\n        }\n\n        return container;\n    },\n\n    _updateSubmit: function(err, resp) {\n        L.DomUtil.removeClass(this._container, 'searching');\n        this._results.innerHTML = '';\n        if (err || !resp) {\n            this.fire('error', {error: err});\n        } else {\n            var features = [];\n            if (resp.results && resp.results.features) {\n                features = resp.results.features;\n            }\n            if (features.length === 1) {\n                this.fire('autoselect', { feature: features[0] });\n                this.fire('found', {results: resp.results});\n                this._chooseResult(features[0]);\n                this._closeIfOpen();\n            } else if (features.length > 1) {\n                this.fire('found', {results: resp.results});\n                this._displayResults(features);\n            } else {\n                this.fire('notfound');\n                this._displayResults(features);\n            }\n        }\n    },\n\n    _updateAutocomplete: function(err, resp) {\n        this._results.innerHTML = '';\n        if (err || !resp) {\n            this.fire('error', {error: err});\n        } else {\n            var features = [];\n            if (resp.results && resp.results.features) {\n                features = resp.results.features;\n            }\n            if (features.length) {\n                this.fire('found', {results: resp.results});\n            } else {\n                this.fire('notfound');\n            }\n            this._displayResults(features);\n        }\n    },\n\n    _displayResults: function(features) {\n        for (var i = 0, l = Math.min(features.length, 5); i < l; i++) {\n            var feature = features[i];\n            var name = feature.place_name;\n            if (!name.length) continue;\n\n            var r = L.DomUtil.create('a', '', this._results);\n            var text = ('innerText' in r) ? 'innerText' : 'textContent';\n            r[text] = name;\n            r.setAttribute('title', name);\n            r.href = '#';\n\n            (L.bind(function(feature) {\n                L.DomEvent.addListener(r, 'click', function(e) {\n                    this._chooseResult(feature);\n                    L.DomEvent.stop(e);\n                    this.fire('select', { feature: feature });\n                }, this);\n            }, this))(feature);\n        }\n        if (features.length > 5) {\n            var outof = L.DomUtil.create('span', '', this._results);\n            outof.innerHTML = 'Top 5 of ' + features.length + '  results';\n        }\n    },\n\n    _chooseResult: function(result) {\n        if (result.bbox) {\n            this._map.fitBounds(util.lbounds(result.bbox));\n        } else if (result.center) {\n            this._map.setView([result.center[1], result.center[0]], (this._map.getZoom() === undefined) ?\n                this.options.pointZoom :\n                Math.max(this._map.getZoom(), this.options.pointZoom));\n        }\n    },\n\n    _geocode: function(e) {\n        L.DomEvent.preventDefault(e);\n        if (this._input.value === '') return this._updateSubmit();\n        L.DomUtil.addClass(this._container, 'searching');\n        this.geocoder.query(L.Util.extend({\n            query: this._input.value,\n            proximity: this.options.proximity ? this._map.getCenter() : false\n        }, this.options.queryOptions), this._updateSubmit);\n    },\n\n    _autocomplete: function() {\n        if (!this.options.autocomplete) return;\n        if (this._input.value === '') return this._updateAutocomplete();\n        this.geocoder.query(L.Util.extend({\n            query: this._input.value,\n            proximity: this.options.proximity ? this._map.getCenter() : false\n        }, this.options.queryOptions), this._updateAutocomplete);\n    }\n});\n\nmodule.exports.GeocoderControl = GeocoderControl;\n\nmodule.exports.geocoderControl = function(_, options) {\n    return new GeocoderControl(_, options);\n};\n","'use strict';\n\nfunction utfDecode(c) {\n    if (c >= 93) c--;\n    if (c >= 35) c--;\n    return c - 32;\n}\n\nmodule.exports = function(data) {\n    return function(x, y) {\n        if (!data) return;\n        var idx = utfDecode(data.grid[y].charCodeAt(x)),\n            key = data.keys[idx];\n        return data.data[key];\n    };\n};\n","'use strict';\n\nvar util = require('./util'),\n    Mustache = require('mustache');\n\nvar GridControl = L.Control.extend({\n\n    options: {\n        pinnable: true,\n        follow: false,\n        sanitizer: require('@mapbox/sanitize-caja'),\n        touchTeaser: true,\n        location: true\n    },\n\n    _currentContent: '',\n\n    // pinned means that this control is on a feature and the user has likely\n    // clicked. pinned will not become false unless the user clicks off\n    // of the feature onto another or clicks x\n    _pinned: false,\n\n    initialize: function(_, options) {\n        L.Util.setOptions(this, options);\n        util.strict_instance(_, L.Class, 'L.mapbox.gridLayer');\n        this._layer = _;\n    },\n\n    setTemplate: function(template) {\n        util.strict(template, 'string');\n        this.options.template = template;\n        return this;\n    },\n\n    _template: function(format, data) {\n        if (!data) return;\n        var template = this.options.template || this._layer.getTileJSON().template;\n        if (template) {\n            var d = {};\n            d['__' + format + '__'] = true;\n            return this.options.sanitizer(\n                Mustache.to_html(template, L.extend(d, data)));\n        }\n    },\n\n    // change the content of the tooltip HTML if it has changed, otherwise\n    // noop\n    _show: function(content, o) {\n        if (content === this._currentContent) return;\n\n        this._currentContent = content;\n\n        if (this.options.follow) {\n            this._popup.setContent(content)\n                .setLatLng(o.latLng);\n            if (this._map._popup !== this._popup) this._popup.openOn(this._map);\n        } else {\n            this._container.style.display = 'block';\n            this._contentWrapper.innerHTML = content;\n        }\n    },\n\n    hide: function() {\n        this._pinned = false;\n        this._currentContent = '';\n\n        this._map.closePopup();\n        this._container.style.display = 'none';\n        this._contentWrapper.innerHTML = '';\n\n        L.DomUtil.removeClass(this._container, 'closable');\n\n        return this;\n    },\n\n    _mouseover: function(o) {\n        if (o.data) {\n            L.DomUtil.addClass(this._map._container, 'map-clickable');\n        } else {\n            L.DomUtil.removeClass(this._map._container, 'map-clickable');\n        }\n\n        if (this._pinned) return;\n\n        var content = this._template('teaser', o.data);\n        if (content) {\n            this._show(content, o);\n        } else {\n            this.hide();\n        }\n    },\n\n    _mousemove: function(o) {\n        if (this._pinned) return;\n        if (!this.options.follow) return;\n\n        this._popup.setLatLng(o.latLng);\n    },\n\n    _navigateTo: function(url) {\n        window.top.location.href = url;\n    },\n\n    _click: function(o) {\n\n        var location_formatted = this._template('location', o.data);\n        if (this.options.location && location_formatted &&\n            location_formatted.search(/^https?:/) === 0) {\n            return this._navigateTo(this._template('location', o.data));\n        }\n\n        if (!this.options.pinnable) return;\n\n        var content = this._template('full', o.data);\n\n        if (!content && this.options.touchTeaser && L.Browser.touch) {\n            content = this._template('teaser', o.data);\n        }\n\n        if (content) {\n            L.DomUtil.addClass(this._container, 'closable');\n            this._pinned = true;\n            this._show(content, o);\n        } else if (this._pinned) {\n            L.DomUtil.removeClass(this._container, 'closable');\n            this._pinned = false;\n            this.hide();\n        }\n    },\n\n    _onPopupClose: function() {\n        this._currentContent = null;\n        this._pinned = false;\n    },\n\n    _createClosebutton: function(container, fn) {\n        var link = L.DomUtil.create('a', 'close', container);\n\n        link.innerHTML = 'close';\n        link.href = '#';\n        link.title = 'close';\n\n        L.DomEvent\n            .on(link, 'click', L.DomEvent.stopPropagation)\n            .on(link, 'mousedown', L.DomEvent.stopPropagation)\n            .on(link, 'dblclick', L.DomEvent.stopPropagation)\n            .on(link, 'click', L.DomEvent.preventDefault)\n            .on(link, 'click', fn, this);\n\n        return link;\n    },\n\n    onAdd: function(map) {\n        this._map = map;\n\n        var className = 'leaflet-control-grid map-tooltip',\n            container = L.DomUtil.create('div', className),\n            contentWrapper = L.DomUtil.create('div', 'map-tooltip-content');\n\n        // hide the container element initially\n        container.style.display = 'none';\n        this._createClosebutton(container, this.hide);\n        container.appendChild(contentWrapper);\n\n        this._contentWrapper = contentWrapper;\n        this._popup = new L.Popup({ autoPan: false, closeOnClick: false });\n\n        map.on('popupclose', this._onPopupClose, this);\n\n        L.DomEvent\n            .disableClickPropagation(container)\n            // allow people to scroll tooltips with mousewheel\n            .addListener(container, 'mousewheel', L.DomEvent.stopPropagation);\n\n        this._layer\n            .on('mouseover', this._mouseover, this)\n            .on('mousemove', this._mousemove, this)\n            .on('click', this._click, this);\n\n        return container;\n    },\n\n    onRemove: function (map) {\n\n        map.off('popupclose', this._onPopupClose, this);\n\n        this._layer\n            .off('mouseover', this._mouseover, this)\n            .off('mousemove', this._mousemove, this)\n            .off('click', this._click, this);\n    }\n});\n\nmodule.exports.GridControl = GridControl;\n\nmodule.exports.gridControl = function(_, options) {\n    return new GridControl(_, options);\n};\n","'use strict';\n\nvar util = require('./util'),\n    request = require('./request'),\n    grid = require('./grid');\n\n// forked from danzel/L.UTFGrid\nvar GridLayer = L.Layer.extend({\n    includes: [require('./load_tilejson')],\n\n    options: {\n        template: function() { return ''; }\n    },\n\n    _mouseOn: null,\n    _tilejson: {},\n    _cache: {},\n\n    initialize: function(_, options) {\n        L.Util.setOptions(this, options);\n        this._loadTileJSON(_);\n    },\n\n    _setTileJSON: function(json) {\n        util.strict(json, 'object');\n\n        L.extend(this.options, {\n            grids: json.grids,\n            minZoom: json.minzoom,\n            maxZoom: json.maxzoom,\n            bounds: json.bounds && util.lbounds(json.bounds)\n        });\n\n        this._tilejson = json;\n        this._cache = {};\n        this._update();\n\n        return this;\n    },\n\n    getTileJSON: function() {\n        return this._tilejson;\n    },\n\n    active: function() {\n        return !!(this._map && this.options.grids && this.options.grids.length);\n    },\n\n    onAdd: function(map) {\n        this._map = map;\n        this._update();\n\n        this._map\n            .on('click', this._click, this)\n            .on('mousemove', this._move, this)\n            .on('moveend', this._update, this);\n    },\n\n    onRemove: function() {\n        this._map\n            .off('click', this._click, this)\n            .off('mousemove', this._move, this)\n            .off('moveend', this._update, this);\n    },\n\n    getData: function(latlng, callback) {\n        if (!this.active()) return;\n\n        var map = this._map,\n            point = map.project(latlng.wrap()),\n            tileSize = 256,\n            resolution = 4,\n            x = Math.floor(point.x / tileSize),\n            y = Math.floor(point.y / tileSize),\n            max = map.options.crs.scale(map.getZoom()) / tileSize;\n\n        x = (x + max) % max;\n        y = (y + max) % max;\n\n        this._getTile(map.getZoom(), x, y, function(grid) {\n            var gridX = Math.floor((point.x - (x * tileSize)) / resolution),\n                gridY = Math.floor((point.y - (y * tileSize)) / resolution);\n\n            callback(grid(gridX, gridY));\n        });\n\n        return this;\n    },\n\n    _click: function(e) {\n        this.getData(e.latlng, L.bind(function(data) {\n            this.fire('click', {\n                latLng: e.latlng,\n                data: data\n            });\n        }, this));\n    },\n\n    _move: function(e) {\n        this.getData(e.latlng, L.bind(function(data) {\n            if (data !== this._mouseOn) {\n                if (this._mouseOn) {\n                    this.fire('mouseout', {\n                        latLng: e.latlng,\n                        data: this._mouseOn\n                    });\n                }\n\n                this.fire('mouseover', {\n                    latLng: e.latlng,\n                    data: data\n                });\n\n                this._mouseOn = data;\n            } else {\n                this.fire('mousemove', {\n                    latLng: e.latlng,\n                    data: data\n                });\n            }\n        }, this));\n    },\n\n    _getTileURL: function(tilePoint) {\n        var urls = this.options.grids,\n            index = (tilePoint.x + tilePoint.y) % urls.length,\n            url = urls[index];\n\n        return L.Util.template(url, tilePoint);\n    },\n\n    // Load up all required json grid files\n    _update: function() {\n        if (!this.active()) return;\n\n        var bounds = this._map.getPixelBounds(),\n            z = this._map.getZoom(),\n            tileSize = 256;\n\n        if (z > this.options.maxZoom || z < this.options.minZoom) return;\n\n        var tileBounds = L.bounds(\n                bounds.min.divideBy(tileSize)._floor(),\n                bounds.max.divideBy(tileSize)._floor()),\n            max = this._map.options.crs.scale(z) / tileSize;\n\n        for (var x = tileBounds.min.x; x <= tileBounds.max.x; x++) {\n            for (var y = tileBounds.min.y; y <= tileBounds.max.y; y++) {\n                // x wrapped\n                this._getTile(z, ((x % max) + max) % max, ((y % max) + max) % max);\n            }\n        }\n    },\n\n    _getTile: function(z, x, y, callback) {\n        var key = z + '_' + x + '_' + y,\n            tilePoint = L.point(x, y);\n\n        tilePoint.z = z;\n\n        if (!this._tileShouldBeLoaded(tilePoint)) {\n            return;\n        }\n\n        if (key in this._cache) {\n            if (!callback) return;\n\n            if (typeof this._cache[key] === 'function') {\n                callback(this._cache[key]); // Already loaded\n            } else {\n                this._cache[key].push(callback); // Pending\n            }\n\n            return;\n        }\n\n        this._cache[key] = [];\n\n        if (callback) {\n            this._cache[key].push(callback);\n        }\n\n        request(this._getTileURL(tilePoint), L.bind(function(err, json) {\n            var callbacks = this._cache[key];\n            this._cache[key] = grid(json);\n            for (var i = 0; i < callbacks.length; ++i) {\n                callbacks[i](this._cache[key]);\n            }\n        }, this));\n    },\n\n    _tileShouldBeLoaded: function(tilePoint) {\n        if (tilePoint.z > this.options.maxZoom || tilePoint.z < this.options.minZoom) {\n            return false;\n        }\n\n        if (this.options.bounds) {\n            var tileSize = 256,\n                nwPoint = tilePoint.multiplyBy(tileSize),\n                sePoint = nwPoint.add(new L.Point(tileSize, tileSize)),\n                nw = this._map.unproject(nwPoint),\n                se = this._map.unproject(sePoint),\n                bounds = new L.LatLngBounds([nw, se]);\n\n            if (!this.options.bounds.intersects(bounds)) {\n                return false;\n            }\n        }\n\n        return true;\n    }\n});\n\nmodule.exports.GridLayer = GridLayer;\n\nmodule.exports.gridLayer = function(_, options) {\n    return new GridLayer(_, options);\n};\n","'use strict';\n\nvar LegendControl = L.Control.extend({\n\n    options: {\n        position: 'bottomright',\n        sanitizer: require('@mapbox/sanitize-caja')\n    },\n\n    initialize: function(options) {\n        L.setOptions(this, options);\n        this._legends = {};\n    },\n\n    onAdd: function() {\n        this._container = L.DomUtil.create('div', 'map-legends wax-legends');\n        L.DomEvent.disableClickPropagation(this._container);\n\n        this._update();\n\n        return this._container;\n    },\n\n    addLegend: function(text) {\n        if (!text) { return this; }\n\n        if (!this._legends[text]) {\n            this._legends[text] = 0;\n        }\n\n        this._legends[text]++;\n        return this._update();\n    },\n\n    removeLegend: function(text) {\n        if (!text) { return this; }\n        if (this._legends[text]) this._legends[text]--;\n        return this._update();\n    },\n\n    _update: function() {\n        if (!this._map) { return this; }\n\n        this._container.innerHTML = '';\n        var hide = 'none';\n\n        for (var i in this._legends) {\n            if (this._legends.hasOwnProperty(i) && this._legends[i]) { // eslint-disable-line no-prototype-builtins\n                var div = L.DomUtil.create('div', 'map-legend wax-legend', this._container);\n                div.innerHTML = this.options.sanitizer(i);\n                hide = 'block';\n            }\n        }\n\n        // hide the control entirely unless there is at least one legend;\n        // otherwise there will be a small grey blemish on the map.\n        this._container.style.display = hide;\n\n        return this;\n    }\n});\n\nmodule.exports.LegendControl = LegendControl;\n\nmodule.exports.legendControl = function(options) {\n    return new LegendControl(options);\n};\n","'use strict';\n\nvar request = require('./request'),\n    format_url = require('./format_url'),\n    util = require('./util');\n\nmodule.exports = {\n    _loadTileJSON: function(_) {\n        if (typeof _ === 'string') {\n            var style = _;\n            _ = format_url.tileJSON(_, this.options && this.options.accessToken);\n            var isGLStyle = _.indexOf('/styles/v1/') !== -1;\n            if (!isGLStyle) {\n                util.warn('Warning: this implementation is loading a Mapbox Studio Classic style (' + style + '). ' +\n                    'Studio Classic styles are scheduled for deprecation: https://blog.mapbox.com/deprecating-studio-classic-styles-c65a744140a6')\n            }\n            request(_, L.bind(function(err, json) {\n                if (err) {\n                    util.log('could not load TileJSON at ' + _);\n                    this.fire('error', {error: err});\n                } else if (json && isGLStyle) {\n                    // In order to preserve compatibility, 256x256 tiles are requested by default\n                    // If you would like better resolution & fewer network requests, use a styleLayer instead\n                    json.tiles = [ format_url('/styles/v1/' + json.owner + '/' + json.id + '/tiles/256/{z}/{x}/{y}', this.options.accessToken) ];\n                    this._setTileJSON(json);\n                    this.fire('ready');\n                } else if (json) {\n                    this._setTileJSON(json);\n                    this.fire('ready');\n                }\n            }, this));\n        } else if (_ && typeof _ === 'object') {\n            this._setTileJSON(_);\n        }\n    }\n};\n","'use strict';\n\nvar tileLayer = require('./tile_layer').tileLayer,\n    featureLayer = require('./feature_layer').featureLayer,\n    gridLayer = require('./grid_layer').gridLayer,\n    gridControl = require('./grid_control').gridControl,\n    shareControl = require('./share_control').shareControl,\n    legendControl = require('./legend_control').legendControl,\n    mapboxLogoControl = require('./mapbox_logo').mapboxLogoControl,\n    feedback = require('./feedback');\n\nfunction withAccessToken(options, accessToken) {\n    if (!accessToken || options.accessToken)\n        return options;\n    return L.extend({accessToken: accessToken}, options);\n}\n\nvar LMap = L.Map.extend({\n    includes: [require('./load_tilejson')],\n\n    options: {\n        tileLayer: {},\n        featureLayer: {},\n        gridLayer: {},\n        legendControl: {},\n        gridControl: {},\n        shareControl: false,\n        sanitizer: require('@mapbox/sanitize-caja')\n    },\n\n    _tilejson: {},\n\n    initialize: function(element, _, options) {\n\n        L.Map.prototype.initialize.call(this, element,\n            L.extend({}, L.Map.prototype.options, options));\n\n        // Disable the default 'Leaflet' text\n        if (this.attributionControl) {\n            this.attributionControl.setPrefix('');\n\n            var compact = this.options.attributionControl.compact;\n            // Set a compact display if map container width is < 640 or\n            // compact is set to `true` in attributionControl options.\n            if (compact || (compact !== false && this._container.offsetWidth <= 640)) {\n                L.DomUtil.addClass(this.attributionControl._container, 'leaflet-compact-attribution');\n            }\n\n            if (compact === undefined) {\n                this.on('resize', function() {\n                    if (this._container.offsetWidth > 640) {\n                        L.DomUtil.removeClass(this.attributionControl._container, 'leaflet-compact-attribution');\n                    } else {\n                        L.DomUtil.addClass(this.attributionControl._container, 'leaflet-compact-attribution');\n                    }\n                });\n            }\n        }\n\n        if (this.options.tileLayer) {\n            this.tileLayer = tileLayer(undefined,\n                withAccessToken(this.options.tileLayer, this.options.accessToken));\n            this.addLayer(this.tileLayer);\n        }\n\n        if (this.options.featureLayer) {\n            this.featureLayer = featureLayer(undefined,\n                withAccessToken(this.options.featureLayer, this.options.accessToken));\n            this.addLayer(this.featureLayer);\n        }\n\n        if (this.options.gridLayer) {\n            this.gridLayer = gridLayer(undefined,\n                withAccessToken(this.options.gridLayer, this.options.accessToken));\n            this.addLayer(this.gridLayer);\n        }\n\n        if (this.options.gridLayer && this.options.gridControl) {\n            this.gridControl = gridControl(this.gridLayer, this.options.gridControl);\n            this.addControl(this.gridControl);\n        }\n\n        if (this.options.legendControl) {\n            this.legendControl = legendControl(this.options.legendControl);\n            this.addControl(this.legendControl);\n        }\n\n        if (this.options.shareControl) {\n            this.shareControl = shareControl(undefined,\n                withAccessToken(this.options.shareControl, this.options.accessToken));\n            this.addControl(this.shareControl);\n        }\n\n        this._mapboxLogoControl = mapboxLogoControl(this.options.mapboxLogoControl);\n        this.addControl(this._mapboxLogoControl);\n\n        this._loadTileJSON(_);\n\n        this.on('layeradd', this._onLayerAdd, this)\n            .on('layerremove', this._onLayerRemove, this)\n            .on('moveend', this._updateMapFeedbackLink, this);\n\n        this.whenReady(function () {\n            feedback.on('change', this._updateMapFeedbackLink, this);\n        });\n\n        this.on('unload', function () {\n            feedback.off('change', this._updateMapFeedbackLink, this);\n        });\n    },\n\n    // use a javascript object of tilejson data to configure this layer\n    _setTileJSON: function(_) {\n        this._tilejson = _;\n        this._initialize(_);\n        return this;\n    },\n\n    getTileJSON: function() {\n        return this._tilejson;\n    },\n\n    _initialize: function(json) {\n        if (this.tileLayer) {\n            this.tileLayer._setTileJSON(json);\n            this._updateLayer(this.tileLayer);\n        }\n\n        if (this.featureLayer && !this.featureLayer.getGeoJSON() && json.data && json.data[0]) {\n            this.featureLayer.loadURL(json.data[0]);\n        }\n\n        if (this.gridLayer) {\n            this.gridLayer._setTileJSON(json);\n            this._updateLayer(this.gridLayer);\n        }\n\n        if (this.legendControl && json.legend) {\n            this.legendControl.addLegend(json.legend);\n        }\n\n        if (this.shareControl) {\n            this.shareControl._setTileJSON(json);\n        }\n\n        this._mapboxLogoControl._setTileJSON(json);\n\n        if (!this._loaded && json.center) {\n            var defaultZoom = (json.zoom) ? json.zoom : json.center[2];\n            var zoom = this.getZoom() !== undefined ? this.getZoom() : defaultZoom,\n                center = L.latLng(json.center[1], json.center[0]);\n\n            this.setView(center, zoom);\n        }\n    },\n\n    _updateMapFeedbackLink: function() {\n        if (!this._controlContainer || !this._controlContainer.getElementsByClassName) return;\n        var link = this._controlContainer.getElementsByClassName('mapbox-improve-map');\n        if (link.length && this._loaded) {\n            var center = this.getCenter().wrap();\n            var tilejson = this._tilejson || {};\n            var id = tilejson.id || '';\n\n            var hash = '#' + id + '/' +\n                center.lng.toFixed(3) + '/' +\n                center.lat.toFixed(3) + '/' +\n                this.getZoom();\n\n            for (var key in feedback.data) {\n                hash += '/' + key + '=' + feedback.data[key];\n            }\n\n            for (var i = 0; i < link.length; i++) {\n                link[i].hash = hash;\n            }\n        }\n    },\n\n    _onLayerAdd: function(e) {\n        if ('on' in e.layer) {\n            e.layer.on('ready', this._onLayerReady, this);\n        }\n        window.setTimeout(L.bind(this._updateMapFeedbackLink, this), 0); // Update after attribution control resets the HTML.\n    },\n\n    _onLayerRemove: function(e) {\n        if ('on' in e.layer) {\n            e.layer.off('ready', this._onLayerReady, this);\n        }\n        window.setTimeout(L.bind(this._updateMapFeedbackLink, this), 0); // Update after attribution control resets the HTML.\n    },\n\n    _onLayerReady: function(e) {\n        this._updateLayer(e.target);\n    },\n\n    _updateLayer: function(layer) {\n        if (!layer.options) return;\n\n        if (this.attributionControl && this._loaded && layer.getAttribution) {\n            this.attributionControl.addAttribution(layer.getAttribution());\n        }\n\n        if (!(L.stamp(layer) in this._zoomBoundLayers) &&\n                (layer.options.maxZoom || layer.options.minZoom)) {\n            this._zoomBoundLayers[L.stamp(layer)] = layer;\n        }\n\n        // ensure logo appears even when mapbox layer added after map is initialized\n        var mapboxLogoControl = this._mapboxLogoControl.getContainer();\n        if (!L.DomUtil.hasClass(mapboxLogoControl, 'mapbox-logo-true')) {\n            var tileJSON = layer._tilejson;\n            this._mapboxLogoControl._setTileJSON(tileJSON);\n        }\n\n        this._updateMapFeedbackLink();\n        this._updateZoomLevels();\n    }\n});\n\nmodule.exports.Map = LMap;\n\nmodule.exports.map = function(element, _, options) {\n    return new LMap(element, _, options);\n};\n","'use strict';\n\nvar geocoderControl = require('./geocoder_control'),\n    gridControl = require('./grid_control'),\n    featureLayer = require('./feature_layer'),\n    legendControl = require('./legend_control'),\n    shareControl = require('./share_control'),\n    tileLayer = require('./tile_layer'),\n    map = require('./map'),\n    gridLayer = require('./grid_layer'),\n    styleLayer = require('./style_layer');\n\nL.mapbox = module.exports = {\n    VERSION: require('../package.json').version,\n    geocoder: require('./geocoder'),\n    marker: require('./marker'),\n    simplestyle: require('./simplestyle'),\n    tileLayer: tileLayer.tileLayer,\n    TileLayer: tileLayer.TileLayer,\n    styleLayer: styleLayer.styleLayer,\n    StyleLayer: styleLayer.StyleLayer,\n    shareControl: shareControl.shareControl,\n    ShareControl: shareControl.ShareControl,\n    legendControl: legendControl.legendControl,\n    LegendControl: legendControl.LegendControl,\n    geocoderControl: geocoderControl.geocoderControl,\n    GeocoderControl: geocoderControl.GeocoderControl,\n    gridControl: gridControl.gridControl,\n    GridControl: gridControl.GridControl,\n    gridLayer: gridLayer.gridLayer,\n    GridLayer: gridLayer.GridLayer,\n    featureLayer: featureLayer.featureLayer,\n    FeatureLayer: featureLayer.FeatureLayer,\n    map: map.map,\n    Map: map.Map,\n    config: require('./config'),\n    sanitize: require('@mapbox/sanitize-caja'),\n    template: require('mustache').to_html,\n    feedback: require('./feedback')\n};\n\n\n// Hardcode image path, because Leaflet's autodetection\n// fails, because mapbox.js is not named leaflet.js\nwindow.L.Icon.Default.imagePath =\n    // Detect bad-news protocols like file:// and hardcode\n    // to https if they're detected.\n    ((document.location.protocol === 'https:' ||\n    document.location.protocol === 'http:') ? '' : 'https:') +\n    '//api.tiles.mapbox.com/mapbox.js/' + 'v' +\n    require('../package.json').version + '/images/';\n","'use strict';\n\nvar MapboxLogoControl = L.Control.extend({\n\n    options: {\n        position: 'bottomleft'\n    },\n\n    initialize: function(options) {\n        L.setOptions(this, options);\n    },\n\n    onAdd: function() {\n        this._container = L.DomUtil.create('div', 'mapbox-logo');\n        return this._container;\n    },\n\n    _setTileJSON: function(json) {\n        // Check if account referenced by the accessToken\n        // is asscociated with the Mapbox Logo\n        // as determined by mapbox-maps.\n        if (json.mapbox_logo) {\n            L.DomUtil.addClass(this._container, 'mapbox-logo-true');\n        }\n\n        // account for usage of styleJSON as functional tileJSON for defaults\n        if (!json.tilejson && json.owner === 'mapbox') {\n            L.DomUtil.addClass(this._container, 'mapbox-logo-true');\n        }\n    }\n});\n\nmodule.exports.MapboxLogoControl = MapboxLogoControl;\n\nmodule.exports.mapboxLogoControl = function(options) {\n    return new MapboxLogoControl(options);\n};\n","'use strict';\n\nvar format_url = require('./format_url'),\n    util = require('./util'),\n    sanitize = require('@mapbox/sanitize-caja');\n\n// mapbox-related markers functionality\n// provide an icon from mapbox's simple-style spec and hosted markers\n// service\nfunction icon(fp, options) {\n    fp = fp || {};\n\n    var sizes = {\n            small: [20, 50],\n            medium: [30, 70],\n            large: [35, 90]\n        },\n        size = fp['marker-size'] || 'medium',\n        symbol = ('marker-symbol' in fp && fp['marker-symbol'] !== '') ? '-' + fp['marker-symbol'] : '',\n        color = (fp['marker-color'] || '7e7e7e').replace('#', '');\n\n    return L.icon({\n        iconUrl: format_url('/v4/marker/' +\n            'pin-' + size.charAt(0) + symbol + '+' + color +\n            // detect and use retina markers, which are x2 resolution\n            (L.Browser.retina ? '@2x' : '') + '.png', options && options.accessToken),\n        iconSize: sizes[size],\n        iconAnchor: [sizes[size][0] / 2, sizes[size][1] / 2],\n        popupAnchor: [0, -sizes[size][1] / 2]\n    });\n}\n\n// a factory that provides markers for Leaflet from Mapbox's\n// [simple-style specification](https://github.com/mapbox/simplestyle-spec)\n// and [Markers API](http://mapbox.com/developers/api/#markers).\nfunction style(f, latlon, options) {\n    return L.marker(latlon, {\n        icon: icon(f.properties, options),\n        title: util.strip_tags(\n            sanitize((f.properties && f.properties.title) || ''))\n    });\n}\n\n// Sanitize and format properties of a GeoJSON Feature object in order\n// to form the HTML string used as the argument for `L.createPopup`\nfunction createPopup(f, sanitizer) {\n    if (!f || !f.properties) return '';\n    var popup = '';\n\n    if (f.properties.title) {\n        popup += '<div class=\"marker-title\">' + f.properties.title + '</div>';\n    }\n\n    if (f.properties.description) {\n        popup += '<div class=\"marker-description\">' + f.properties.description + '</div>';\n    }\n\n    return (sanitizer || sanitize)(popup);\n}\n\nmodule.exports = {\n    icon: icon,\n    style: style,\n    createPopup: createPopup\n};\n","'use strict';\n\nvar corslite = require('@mapbox/corslite'),\n    strict = require('./util').strict,\n    config = require('./config');\n\nvar protocol = /^(https?:)?(?=\\/\\/(.|api)\\.tiles\\.mapbox\\.com\\/)/;\n\nmodule.exports = function(url, callback) {\n    strict(url, 'string');\n    strict(callback, 'function');\n\n    url = url.replace(protocol, function(match, protocol) {\n        if (!('withCredentials' in new window.XMLHttpRequest())) {\n            // XDomainRequest in use; doesn't support cross-protocol requests\n            return document.location.protocol;\n        } else if (protocol === 'https:' || document.location.protocol === 'https:' || config.FORCE_HTTPS) {\n            return 'https:';\n        } else {\n            return 'http:';\n        }\n    });\n\n    function onload(err, resp) {\n        if (!err && resp) {\n            resp = JSON.parse(resp.responseText);\n        }\n        callback(err, resp);\n    }\n\n    return corslite(url, onload);\n};\n","'use strict';\n\nvar format_url = require('./format_url');\n\nvar ShareControl = L.Control.extend({\n    includes: [require('./load_tilejson')],\n\n    options: {\n        position: 'topleft',\n        url: ''\n    },\n\n    initialize: function(_, options) {\n        L.setOptions(this, options);\n        this._loadTileJSON(_);\n    },\n\n    _setTileJSON: function(json) {\n        this._tilejson = json;\n    },\n\n    onAdd: function(map) {\n        this._map = map;\n\n        var container = L.DomUtil.create('div', 'leaflet-control-mapbox-share leaflet-bar');\n        var link = L.DomUtil.create('a', 'mapbox-share mapbox-icon mapbox-icon-share', container);\n        link.href = '#';\n\n        this._modal = L.DomUtil.create('div', 'mapbox-modal', this._map._container);\n        this._mask = L.DomUtil.create('div', 'mapbox-modal-mask', this._modal);\n        this._content = L.DomUtil.create('div', 'mapbox-modal-content', this._modal);\n\n        L.DomEvent.addListener(link, 'click', this._shareClick, this);\n        L.DomEvent.disableClickPropagation(container);\n\n        this._map.on('mousedown', this._clickOut, this);\n\n        return container;\n    },\n\n    _clickOut: function(e) {\n        if (this._sharing) {\n            L.DomEvent.preventDefault(e);\n            L.DomUtil.removeClass(this._modal, 'active');\n            this._content.innerHTML = '';\n            this._sharing = null;\n            return;\n        }\n    },\n\n    _shareClick: function(e) {\n        L.DomEvent.stop(e);\n        if (this._sharing) return this._clickOut(e);\n\n        var tilejson = this._tilejson || this._map._tilejson || {},\n            url = encodeURIComponent(this.options.url || tilejson.webpage || window.location),\n            name = encodeURIComponent(tilejson.name),\n            image = format_url('/v4/' + tilejson.id + '/' + this._map.getCenter().lng + ',' + this._map.getCenter().lat + ',' + this._map.getZoom() + '/600x600.png', this.options.accessToken),\n            embed = format_url('/v4/' + tilejson.id + '.html', this.options.accessToken),\n            twitterURL = '//twitter.com/intent/tweet?status=' + name + ' ' + url,\n            facebookURL = '//www.facebook.com/sharer.php?u=' + url + '&t=' + name,\n            pinterestURL = '//www.pinterest.com/pin/create/button/?url=' + url + '&media=' + image + '&description=' + name,\n            embedValue = '<iframe width=\"100%\" height=\"500px\" frameBorder=\"0\" src=\"' + embed + '\"></iframe>',\n            embedLabel = 'Copy and paste this <strong>HTML code</strong> into documents to embed this map on web pages.';\n\n        function createShareButton(buttonClass, href, socialMediaName) {\n            var elem = document.createElement('a');\n            elem.setAttribute('class', buttonClass);\n            elem.setAttribute('href', href);\n            elem.setAttribute('target', '_blank');\n            socialMediaName = document.createTextNode(socialMediaName);\n            elem.appendChild(socialMediaName);\n\n            return elem;\n        }\n\n        L.DomUtil.addClass(this._modal, 'active');\n\n        this._sharing = L.DomUtil.create('div', 'mapbox-modal-body', this._content);\n\n        var twitterButton = createShareButton('mapbox-button mapbox-button-icon mapbox-icon-twitter', twitterURL, 'Twitter');\n        var facebookButton = createShareButton('mapbox-button mapbox-button-icon mapbox-icon-facebook', facebookURL, 'Facebook');\n        var pinterestButton = createShareButton('mapbox-button mapbox-button-icon mapbox-icon-pinterest', pinterestURL, 'Pinterest');\n\n        var shareHeader = document.createElement('h3');\n        var shareText = document.createTextNode('Share this map');\n        shareHeader.appendChild(shareText);\n\n        var shareButtons = document.createElement('div');\n        shareButtons.setAttribute('class', 'mapbox-share-buttons');\n        shareButtons.appendChild(facebookButton);\n        shareButtons.appendChild(twitterButton);\n        shareButtons.appendChild(pinterestButton);\n\n        this._sharing.appendChild(shareHeader);\n        this._sharing.appendChild(shareButtons);\n\n        var input = L.DomUtil.create('input', 'mapbox-embed', this._sharing);\n        input.type = 'text';\n        input.value = embedValue;\n\n        var label = L.DomUtil.create('label', 'mapbox-embed-description', this._sharing);\n        label.innerHTML = embedLabel;\n\n        var close = L.DomUtil.create('a', 'leaflet-popup-close-button', this._sharing);\n        close.href = '#';\n\n        L.DomEvent.disableClickPropagation(this._sharing);\n        L.DomEvent.addListener(close, 'click', this._clickOut, this);\n        L.DomEvent.addListener(input, 'click', function(e) {\n            e.target.focus();\n            e.target.select();\n        });\n    }\n});\n\nmodule.exports.ShareControl = ShareControl;\n\nmodule.exports.shareControl = function(_, options) {\n    return new ShareControl(_, options);\n};\n","'use strict';\n\n// an implementation of the simplestyle spec for polygon and linestring features\n// https://github.com/mapbox/simplestyle-spec\nvar defaults = {\n    stroke: '#555555',\n    'stroke-width': 2,\n    'stroke-opacity': 1,\n    fill: '#555555',\n    'fill-opacity': 0.5\n};\n\nvar mapping = [\n    ['stroke', 'color'],\n    ['stroke-width', 'weight'],\n    ['stroke-opacity', 'opacity'],\n    ['fill', 'fillColor'],\n    ['fill-opacity', 'fillOpacity']\n];\n\nfunction fallback(a, b) {\n    var c = {};\n    for (var k in b) {\n        if (a[k] === undefined) c[k] = b[k];\n        else c[k] = a[k];\n    }\n    return c;\n}\n\nfunction remap(a) {\n    var d = {};\n    for (var i = 0; i < mapping.length; i++) {\n        d[mapping[i][1]] = a[mapping[i][0]];\n    }\n    return d;\n}\n\nfunction style(feature) {\n    return remap(fallback(feature.properties || {}, defaults));\n}\n\nmodule.exports = {\n    style: style,\n    defaults: defaults\n};\n","'use strict';\n\nvar util = require('./util');\nvar format_url = require('./format_url');\nvar request = require('./request');\n\nvar StyleLayer = L.TileLayer.extend({\n\n    options: {\n        sanitizer: require('@mapbox/sanitize-caja')\n    },\n\n    initialize: function(_, options) {\n        L.TileLayer.prototype.initialize.call(this, undefined, L.extend({}, options, {\n            tileSize: 512,\n            zoomOffset: -1,\n            minNativeZoom: 0,\n            tms: false\n        }));\n        this._url = this._formatTileURL(_);\n        this._getAttribution(_);\n    },\n\n    _getAttribution: function(_) {\n        var styleURL = format_url.style(_, this.options && this.options.accessToken);\n        request(styleURL, L.bind(function(err, style) {\n            if (err) {\n                util.log('could not load Mapbox style at ' + styleURL);\n                this.fire('error', {error: err});\n            }\n            var sources = [];\n            for (var id in style.sources) {\n                var source = style.sources[id].url.split('mapbox://')[1];\n                sources.push(source);\n            }\n            request(format_url.tileJSON(sources.join(), this.options.accessToken), L.bind(function(err, json) {\n                if (err) {\n                    util.log('could not load TileJSON at ' + _);\n                    this.fire('error', {error: err});\n                } else if (json) {\n                    util.strict(json, 'object');\n\n                    this.options.attribution = this.options.sanitizer(json.attribution);\n\n                    this._tilejson = json;\n                    this.fire('ready');\n                }\n            }, this));\n        }, this));\n    },\n\n    // disable the setUrl function, which is not available on mapbox tilelayers\n    setUrl: null,\n\n    _formatTileURL: function(style) {\n        if (typeof style === 'string') {\n            if (style.indexOf('mapbox://styles/') === -1) {\n                util.log('Incorrectly formatted Mapbox style at ' + style);\n                this.fire('error');\n            }\n            var ownerIDStyle = style.split('mapbox://styles/')[1];\n            return format_url('/styles/v1/' + ownerIDStyle + '/tiles/{z}/{x}/{y}{r}', this.options.accessToken);\n        } else if (typeof style === 'object') {\n            return format_url('/styles/v1/' + style.owner + '/' + style.id + '/tiles/{z}/{x}/{y}{r}', this.options.accessToken);\n        }\n    }\n});\n\nmodule.exports.StyleLayer = StyleLayer;\n\nmodule.exports.styleLayer = function(_, options) {\n    return new StyleLayer(_, options);\n};\n","'use strict';\n\nvar util = require('./util');\nvar formatPattern = /\\.((?:png|jpg)\\d*)(?=$|\\?)/;\n\nvar TileLayer = L.TileLayer.extend({\n    includes: [require('./load_tilejson')],\n\n    options: {\n        sanitizer: require('@mapbox/sanitize-caja')\n    },\n\n    // http://mapbox.com/developers/api/#image_quality\n    formats: [\n        'png', 'jpg',\n        // PNG\n        'png32', 'png64', 'png128', 'png256',\n        // JPG\n        'jpg70', 'jpg80', 'jpg90'],\n\n    scalePrefix: '@2x.',\n\n    initialize: function(_, options) {\n        L.TileLayer.prototype.initialize.call(this, undefined, options);\n\n        this._tilejson = {};\n\n        if (options && options.format) {\n            util.strict_oneof(options.format, this.formats);\n        }\n\n        this._loadTileJSON(_);\n    },\n\n    setFormat: function(_) {\n        util.strict(_, 'string');\n        this.options.format = _;\n        this.redraw();\n        return this;\n    },\n\n    // disable the setUrl function, which is not available on mapbox tilelayers\n    setUrl: null,\n\n    _setTileJSON: function(json) {\n        util.strict(json, 'object');\n\n        if (!this.options.format) {\n          var match = json.tiles[0].match(formatPattern);\n          if (match) {\n              this.options.format = match[1];\n          }\n        }\n\n        L.extend(this.options, {\n            tiles: json.tiles,\n            attribution: this.options.sanitizer(json.attribution),\n            minZoom: json.minzoom || 0,\n            maxZoom: json.maxzoom || 18,\n            tms: json.scheme === 'tms',\n            bounds: json.bounds && util.lbounds(json.bounds)\n        });\n\n        this._tilejson = json;\n        this.redraw();\n        return this;\n    },\n\n    getTileJSON: function() {\n        return this._tilejson;\n    },\n\n    // this is an exception to mapbox.js naming rules because it's called\n    // by `L.map`\n    getTileUrl: function(tilePoint) {\n        var tiles = this.options.tiles,\n            index = Math.floor(Math.abs(tilePoint.x + tilePoint.y) % tiles.length),\n            url = tiles[index];\n\n        var templated = L.Util.template(url, tilePoint);\n        if (!templated || !this.options.format) {\n            var tileURL;\n            if (L.Browser.retina && url.indexOf('/styles/v1') !== -1) {\n                tileURL = templated.replace('?', '@2x?');\n            } else {\n                tileURL = templated;\n            }\n\n            return tileURL\n        } else {\n            return templated.replace(formatPattern,\n                (L.Browser.retina ? this.scalePrefix : '.') + this.options.format);\n        }\n    },\n\n    // TileJSON.TileLayers are added to the map immediately, so that they get\n    // the desired z-index, but do not update until the TileJSON has been loaded.\n    _update: function() {\n        if (this.options.tiles) {\n            L.TileLayer.prototype._update.call(this);\n        }\n    }\n});\n\nmodule.exports.TileLayer = TileLayer;\n\nmodule.exports.tileLayer = function(_, options) {\n    return new TileLayer(_, options);\n};\n","'use strict';\n\nfunction contains(item, list) {\n    if (!list || !list.length) return false;\n    for (var i = 0; i < list.length; i++) {\n        if (list[i] === item) return true;\n    }\n    return false;\n}\n\nvar warnOnceHistory = {};\n\nmodule.exports = {\n    idUrl: function(_, t) {\n        if (_.indexOf('/') === -1) t.loadID(_);\n        else t.loadURL(_);\n    },\n    log: function(_) {\n        /* eslint-disable no-console */\n        if (typeof console === 'object' &&\n            typeof console.error === 'function') {\n            console.error(_);\n        }\n    },\n    warn: function(_) {\n        // avoid cluttering the console with duplicative warnings\n        if (warnOnceHistory[_]) return;\n        if (typeof console === 'object' && \n            typeof console.warn === 'function') {\n            warnOnceHistory[_] = true;\n            console.warn(_);\n        }\n        /* eslint-enable no-console */\n    },\n    strict: function(_, type) {\n        if (typeof _ !== type) {\n            throw new Error('Invalid argument: ' + type + ' expected');\n        }\n    },\n    strict_instance: function(_, klass, name) {\n        if (!(_ instanceof klass)) {\n            throw new Error('Invalid argument: ' + name + ' expected');\n        }\n    },\n    strict_oneof: function(_, values) {\n        if (!contains(_, values)) {\n            throw new Error('Invalid argument: ' + _ + ' given, valid values are ' +\n                values.join(', '));\n        }\n    },\n    strip_tags: function(_) {\n        return _.replace(/<[^<]+>/g, '');\n    },\n    lbounds: function(_) {\n        // leaflet-compatible bounds, since leaflet does not do geojson\n        return new L.LatLngBounds([[_[1], _[0]], [_[3], _[2]]]);\n    }\n};\n"]}